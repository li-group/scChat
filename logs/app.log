
2025-08-26 14:07:47,526 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:07:53,681 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:07:53,709 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:07:54,509 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:07:56,167 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:07:56,257 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:07:56,257 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:07:56,266 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:07:57,296 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 14:07:57,297 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 14:07:57,301 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 14:08:08,119 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:08:09,279 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:08:09,281 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:08:17,947 | INFO | scchatbot.multi_agent_base | 🧹 Starting cleanup...
2025-08-26 14:08:17,947 | INFO | scchatbot.multi_agent_base | ✅ Cleanup completed
2025-08-26 14:11:38,109 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:11:42,857 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:11:42,883 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:11:43,563 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:11:45,173 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:11:45,256 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:11:45,257 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:11:45,266 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:11:46,288 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 14:11:46,288 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 14:11:46,290 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 14:12:02,660 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:12:18,695 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:14:34,566 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:14:35,397 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 14:14:35,398 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 14:14:35,398 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 14:14:35,996 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 14:14:35,996 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 14:14:37,381 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 14:14:37,383 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 14:14:37,383 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 14:14:42,752 | ERROR | django.request | Internal Server Error: /
Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 187, in _get_session
    return self._session_cache
           ^^^^^^^^^^^^^^^^^^^
AttributeError: 'SessionStore' object has no attribute '_session_cache'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such table: django_session

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/views/decorators/http.py", line 43, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/views.py", line 36, in chat_with_ai
    room_name = request.session.get('chat_room', 'default')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 68, in get
    return self._session.get(key, default)
           ^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 192, in _get_session
    self._session_cache = self.load()
                          ^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/db.py", line 42, in load
    s = self._get_session_from_db()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/db.py", line 32, in _get_session_from_db
    return self.model.objects.get(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 633, in get
    num = len(clone)
          ^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 380, in __len__
    self._fetch_all()
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 1881, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 102, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 67, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 80, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 84, in _execute
    with self.db.wrap_database_errors:
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: no such table: django_session
2025-08-26 14:15:14,233 | ERROR | django.request | Internal Server Error: /
Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 187, in _get_session
    return self._session_cache
           ^^^^^^^^^^^^^^^^^^^
AttributeError: 'SessionStore' object has no attribute '_session_cache'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such table: django_session

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/views/decorators/csrf.py", line 56, in wrapper_view
    return view_func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/views/decorators/http.py", line 43, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/views.py", line 36, in chat_with_ai
    room_name = request.session.get('chat_room', 'default')
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 68, in get
    return self._session.get(key, default)
           ^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/base.py", line 192, in _get_session
    self._session_cache = self.load()
                          ^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/db.py", line 42, in load
    s = self._get_session_from_db()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/contrib/sessions/backends/db.py", line 32, in _get_session_from_db
    return self.model.objects.get(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 633, in get
    num = len(clone)
          ^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 380, in __len__
    self._fetch_all()
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 1881, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/models/sql/compiler.py", line 1562, in execute_sql
    cursor.execute(sql, params)
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 102, in execute
    return super().execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 67, in execute
    return self._execute_with_wrappers(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 80, in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 84, in _execute
    with self.db.wrap_database_errors:
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/utils.py", line 89, in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/ScChatbot/lib/python3.11/site-packages/django/db/backends/sqlite3/base.py", line 328, in execute
    return super().execute(query, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
django.db.utils.OperationalError: no such table: django_session
2025-08-26 14:19:24,023 | INFO | numexpr.utils | NumExpr defaulting to 14 threads.
2025-08-26 14:20:19,899 | INFO | numexpr.utils | NumExpr defaulting to 14 threads.
2025-08-26 14:21:12,075 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:21:12,089 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:21:12,743 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:21:14,445 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:21:14,529 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:21:14,530 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:21:14,539 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:21:15,475 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 14:21:15,475 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 14:21:15,477 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 14:21:29,486 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:21:47,064 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:23:46,416 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:23:47,463 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 14:23:47,463 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 14:23:47,463 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 14:23:48,050 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 14:23:48,050 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 14:23:49,578 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 14:23:49,580 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 14:23:49,580 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 14:24:31,463 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:24:35,764 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:24:35,778 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:24:36,428 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:24:38,239 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:24:38,289 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:24:38,289 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:24:38,299 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:24:39,209 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 14:24:39,210 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 14:24:39,211 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 14:24:54,118 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:24:59,069 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:27:12,191 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 502 Bad Gateway"
2025-08-26 14:27:12,194 | INFO | openai._base_client | Retrying request to /chat/completions in 0.387078 seconds
2025-08-26 14:27:17,565 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 502 Bad Gateway"
2025-08-26 14:27:17,566 | INFO | openai._base_client | Retrying request to /chat/completions in 0.799702 seconds
2025-08-26 14:27:39,306 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:27:40,167 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 14:27:40,167 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 14:27:40,167 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 14:27:40,808 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 14:27:40,808 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 14:27:42,160 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 14:27:42,162 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 14:27:42,162 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 14:28:49,645 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:28:52,676 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:28:55,691 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:29:07,739 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 14:29:07,741 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 14:29:07,741 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:29:08,469 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:29:08,473 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 14:29:08,474 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Compare the cell counts of each condition for T cell.'
2025-08-26 14:29:11,589 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:29:12,715 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:29:12,718 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 14:29:12,718 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 14:29:12,718 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(T cell)
2025-08-26 14:29:12,769 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 14:29:12,795 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 14:29:12,796 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 14:29:12,796 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 14:29:12,796 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 14:29:12,798 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 14:29:12,798 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 14:29:12,798 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 14:29:12,799 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 14:29:12,799 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 14:29:12,799 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 14:29:12,799 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 14:29:12,800 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 14:29:12,800 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 14:29:12,800 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 14:29:12,801 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 14:29:12,801 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 14:29:12,801 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 14:29:12,801 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 14:29:12,803 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:29:12,803 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:29:12,805 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 14:29:12,805 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 14:29:18,273 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:29:26,300 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:10,734 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:10,743 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 14:30:10,744 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 14:30:10,744 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 14:30:10,766 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 14:30:10,766 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 14:30:10,766 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 14:30:10,766 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 14:30:10,766 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 14:30:10,768 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 14:30:10,768 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 14:30:10,768 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:30:10,769 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:30:10,769 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 14:30:10,769 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 14:30:10,769 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 14:30:10,769 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Glial cell', 'Mast cell', 'Stromal cell', 'Natural killer cell', 'Epithelial cell', 'Mononuclear phagocyte', 'B cell', 'T cell']}
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: compare_cell_counts(cell_type='T cell')
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_cell_count_comparison(params={'cell_types_data': 'results from compare_cell_counts step'})
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'None' not in missing list []
2025-08-26 14:30:10,770 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 14:30:10,771 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:30:10,771 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:30:10,772 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Compare the cell counts of T cells between different experimental conditions.
2025-08-26 14:30:10,772 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:30:10,773 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='T cell', kwargs={'cell_type': 'T cell'}
2025-08-26 14:30:10,773 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: T cell
2025-08-26 14:30:10,798 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 14:30:10,805 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:30:10,805 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 14:30:10,805 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:30:10,805 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:30:10,805 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/4), skipping post-execution evaluation
2025-08-26 14:30:10,806 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:30:10,806 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:30:10,806 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Visualize the comparison of T cell counts across different conditions.
2025-08-26 14:30:10,807 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_cell_count_comparison'
2025-08-26 14:30:10,807 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_cell_count_comparison called with kwargs: {'cell_types_data': 'results from compare_cell_counts step'}
2025-08-26 14:30:10,807 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_cell_count_comparison - HTML preserved
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:30:10,808 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:30:12,276 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:12,943 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:12,952 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:30:12,952 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:30:13,746 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:13,749 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:30:14,774 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:14,793 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:30:14,799 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:30:14,800 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:30:14,800 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 14:30:14,800 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 3)
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:30:14,801 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 14:30:14,802 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 14:30:14,802 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:30:14,802 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:30:14,802 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:30:14,802 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:30:14,804 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 14:30:14,804 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:30:14,804 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:30:15,906 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:16,494 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:16,497 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:30:16,497 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:30:17,226 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:17,227 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:30:17,843 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:17,846 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 3)
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:30:17,847 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:30:17,848 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:30:17,849 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 14:30:17,851 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 14:30:17,851 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 14:30:17,851 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 14:30:17,851 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 14:30:17,851 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: compare_cell_counts for T cell
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_cell_count_comparison for step_3
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_cell_count_comparison
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_types_data': 'results from compare_cell_counts step'}
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_cell_count_comparison with VisualizationResultAccessor
2025-08-26 14:30:17,852 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 873 characters for synthesis
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 14:30:17,853 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 14:30:19,024 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:30:19,027 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 14:30:19,028 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 14:30:19,028 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 14:30:19,028 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: compare_cell_counts, success=True, has_result=True
2025-08-26 14:30:19,028 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_cell_count_comparison, success=True, has_result=True
2025-08-26 14:30:19,029 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Cell Count Comparison (53 chars)
2025-08-26 14:30:19,029 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 53 chars)
2025-08-26 14:30:19,029 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 53 bytes
2025-08-26 14:30:19,030 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 14:30:19,030 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 14:30:19,033 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 14:30:19,034 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (304 chars)
2025-08-26 14:30:19,121 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 14:30:19,121 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 14:34:29,199 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/workflow/nodes/execution.py changed, reloading.
2025-08-26 14:34:31,390 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:35:28,575 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:35:33,331 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:35:33,355 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:35:34,227 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:35:35,960 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:35:36,040 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:35:36,042 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:35:36,053 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:35:36,926 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 14:35:36,927 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 14:35:36,929 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 14:35:54,894 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:36:06,906 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:38:33,480 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:38:34,561 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 14:38:34,561 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 14:38:34,561 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 14:38:35,214 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 14:38:35,214 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 14:38:36,605 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 14:38:36,607 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 14:38:36,607 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 14:40:07,920 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:40:10,965 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:40:13,977 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 14:40:14,405 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 14:40:14,406 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 14:40:14,407 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:40:15,697 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:40:15,708 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 14:40:15,708 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 14:40:15,708 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 14:40:15,708 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 14:40:15,709 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 14:40:15,713 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 14:40:15,714 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:40:15,715 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 14:40:15,715 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 14:40:15,715 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 14:40:15,715 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 14:40:15,715 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Compare the cell counts of each condition for T cell.'
2025-08-26 14:40:18,405 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:40:20,173 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:40:20,182 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 14:40:20,182 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 14:40:20,182 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(T cell)
2025-08-26 14:40:20,306 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 14:40:20,326 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:40:20,327 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:40:20,328 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 14:40:20,328 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 14:40:25,919 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:40:33,682 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:07,599 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:07,606 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 14:41:07,606 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 14:41:07,607 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 14:41:07,626 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 14:41:07,626 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 14:41:07,626 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 14:41:07,626 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 14:41:07,626 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 14:41:07,627 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 14:41:07,627 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 14:41:07,627 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:41:07,627 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['B cell', 'T cell', 'Mast cell', 'Mononuclear phagocyte', 'Epithelial cell', 'Stromal cell', 'Glial cell', 'Natural killer cell']}
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: compare_cell_counts(cell_type='T cell')
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_cell_count_comparison(params={'cell_types_data': 'results from compare_cell_counts'})
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'None' not in missing list []
2025-08-26 14:41:07,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 14:41:07,629 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:41:07,629 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:41:07,629 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Compare the cell counts of T cells between different experimental conditions.
2025-08-26 14:41:07,629 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:41:07,629 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='T cell', kwargs={'cell_type': 'T cell'}
2025-08-26 14:41:07,629 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: T cell
2025-08-26 14:41:07,667 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 14:41:07,671 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:41:07,671 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 14:41:07,671 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:41:07,671 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:41:07,672 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/4), skipping post-execution evaluation
2025-08-26 14:41:07,672 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:41:07,672 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell....
2025-08-26 14:41:07,672 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Visualize the comparison of T cell counts across conditions.
2025-08-26 14:41:07,672 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_cell_count_comparison'
2025-08-26 14:41:07,673 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Handling display_cell_count_comparison - aggregating compare_cell_counts results
2025-08-26 14:41:07,673 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Added data for T cell: dict entries
2025-08-26 14:41:07,673 | INFO | scchatbot.workflow.nodes.execution | ✅ AGGREGATION: Successfully aggregated data for 1 cell types
2025-08-26 14:41:07,673 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_cell_count_comparison called with kwargs: {'cell_types_data': {'T cell': [{'category': 'cataract', 'cell_count': 205, 'description': 'This is a condition where the lens of the eye becomes cloudy.'}, {'category': 'basal laminar drusen', 'cell_count': 153, 'description': "These are deposits that accumulate between the RPE and Bruch's membrane and are a hallmark of aging and a risk factor for AMD."}, {'category': 'age related macular degeneration', 'cell_count': 177, 'description': 'This is a primary focus of the study as it is a leading cause of irreversible blindness where dysfunction of the RPE and choroid is heavily implicated.'}]}}
2025-08-26 14:41:08,175 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 14:41:08,176 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_cell_count_comparison - HTML preserved
2025-08-26 14:41:08,176 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 14:41:08,176 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:41:08,176 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:41:08,177 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 14:41:08,177 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:41:08,177 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:41:09,822 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:10,414 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:10,415 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:41:10,415 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:41:10,922 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:10,957 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:41:11,476 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:11,478 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 3)
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:41:11,479 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:41:11,480 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:41:11,481 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:41:11,481 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:41:11,482 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 14:41:11,482 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:41:11,482 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:41:13,262 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:13,714 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:13,722 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:41:13,722 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:41:14,414 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:14,431 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:41:14,914 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:14,917 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:41:14,917 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:41:14,918 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:41:14,918 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 14:41:14,918 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 3)
2025-08-26 14:41:14,919 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:41:14,919 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:41:14,920 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:41:14,922 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:41:14,922 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:41:14,923 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 14:41:14,923 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 14:41:14,923 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:41:14,923 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:41:14,924 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:41:14,924 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:41:14,924 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 14:41:14,926 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 14:41:14,926 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 14:41:14,926 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 14:41:14,926 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 14:41:14,926 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: compare_cell_counts for T cell
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_cell_count_comparison for step_3
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_cell_count_comparison
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_types_data': 'results from compare_cell_counts'}
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_cell_count_comparison with VisualizationResultAccessor
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 877 characters for synthesis
2025-08-26 14:41:14,927 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 14:41:14,928 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 14:41:14,928 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 14:41:14,928 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 14:41:14,928 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 14:41:16,217 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:16,220 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 14:41:16,223 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: compare_cell_counts, success=True, has_result=True
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_cell_count_comparison, success=True, has_result=True
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Cell Count Comparison (10074 chars)
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 10,074 chars)
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 10,074 bytes
2025-08-26 14:41:16,225 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 14:41:16,226 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 14:41:16,226 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 14:41:16,226 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (283 chars)
2025-08-26 14:41:16,331 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 14:41:16,331 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 14:41:49,603 | INFO | scchatbot.multi_agent_base | 🔄 Reusing session state for '36fac317' with 8 available cell types
2025-08-26 14:41:49,606 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 14:41:49,606 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 14:41:50,279 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:50,282 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removing old context message (56 chars)
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removed 1 old context messages
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 8 cell types: ['B cell', 'T cell', 'Mast cell', 'Mononuclear phagocyte', 'Epithelial cell', 'Stromal cell', 'Glial cell', 'Natural killer cell']
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 250 chars, starts with: 'Cell types currently available in the dataset:
  •...'
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (250 chars)
2025-08-26 14:41:50,283 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'Cell types currently available in the dataset:
  • B cell
  • Epithelial cell
  • Glial cell
  • Mas...'
2025-08-26 14:41:50,284 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (273 chars)
2025-08-26 14:41:50,284 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Preserving 8 discovered cell types from previous operations
2025-08-26 14:41:50,284 | INFO | scchatbot.workflow.nodes.input_processing |    Preserved types: ['B cell', 'Epithelial cell', 'Glial cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Stromal cell', 'T cell']
2025-08-26 14:41:50,284 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 14:41:50,285 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 14:41:50,285 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 14:41:50,285 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 14:41:50,288 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 14:41:50,288 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 8
2025-08-26 14:41:50,288 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 4
2025-08-26 14:41:50,288 | INFO | scchatbot.workflow.nodes.planning |    • New types discovered: B cell, Mast cell, Mononuclear phagocyte, Natural killer cell, T cell
2025-08-26 14:41:50,289 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'What are the cell types we get right now?'
2025-08-26 14:41:51,932 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:52,987 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning | 🔍 No specific cell types identified in question
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 1 steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 1 steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning |    • 0 process_cells steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning |    • 0 validation steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.nodes.planning |    • 0 analysis steps
2025-08-26 14:41:53,009 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 14:41:53,015 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 14:41:53,016 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:41:53,016 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 14:41:53,017 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Respond to the user's query by listing the currently available cell types.
2025-08-26 14:41:53,017 | INFO | scchatbot.workflow.nodes.execution | ℹ️ No function for this step; treating as direct-answer/no-op.
2025-08-26 14:41:53,018 | INFO | scchatbot.workflow.nodes.execution | 📄 Text storage: direct_answer - Truncated to 500 chars
2025-08-26 14:41:53,018 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 14:41:53,018 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:41:53,019 | INFO | scchatbot.workflow.nodes.evaluation | ℹ️ Evaluator: no callable steps in plan; skipping post-execution evaluation.
2025-08-26 14:41:53,019 | INFO | scchatbot.workflow.nodes.evaluation | ℹ️ Evaluator: no callable steps in plan; skipping post-execution evaluation.
2025-08-26 14:41:53,019 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 14:41:53,020 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 14:41:53,020 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 1 execution steps
2025-08-26 14:41:53,020 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: direct_answer for step_0
2025-08-26 14:41:53,020 | INFO | scchatbot.workflow.unified_result_accessor | ⚠️ No accessor found for function: direct_answer
2025-08-26 14:41:53,020 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 1 successful steps
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 64 characters for synthesis
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (273 chars)
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 14:41:53,021 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 14:41:55,317 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:41:55,318 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 1 execution steps
2025-08-26 14:41:55,318 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: direct_answer, success=True, has_result=True
2025-08-26 14:41:55,318 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: No valid plots found
2025-08-26 14:41:55,318 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 0 individual plots
2025-08-26 14:41:55,318 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (389 chars)
2025-08-26 14:41:55,351 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 14:41:55,351 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 14:42:20,039 | INFO | scchatbot.multi_agent_base | 🔄 Reusing session state for '36fac317' with 8 available cell types
2025-08-26 14:42:20,041 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 14:42:20,041 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:20,889 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:20,890 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 14:42:20,890 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removing old context message (273 chars)
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removed 1 old context messages
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 8 cell types: ['B cell', 'T cell', 'Mast cell', 'Mononuclear phagocyte', 'Epithelial cell', 'Stromal cell', 'Glial cell', 'Natural killer cell']
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 226 chars, starts with: 'Cell types currently available in the dataset:
  •...'
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (226 chars)
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'Cell types currently available in the dataset:
  • B cell
  • Epithelial cell
  • Glial cell
  • Mas...'
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (249 chars)
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Preserving 8 discovered cell types from previous operations
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.input_processing |    Preserved types: ['B cell', 'Epithelial cell', 'Glial cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Stromal cell', 'T cell']
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 14:42:20,891 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 8
2025-08-26 14:42:20,892 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 4
2025-08-26 14:42:20,892 | INFO | scchatbot.workflow.nodes.planning |    • New types discovered: B cell, Mast cell, Mononuclear phagocyte, Natural killer cell, T cell
2025-08-26 14:42:20,892 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell.'
2025-08-26 14:42:24,717 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:26,531 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:26,534 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell', 'B cell', 'Glial cell', 'Epithelial cell']
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['B cell', 'T cell', 'Mast cell', 'Mononuclear phagocyte', 'Epithelial cell', 'Stromal cell', 'Glial cell', 'Natural killer cell']
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(T cell)
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(B cell)
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(Glial cell)
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: compare_cell_counts(Epithelial cell)
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | ✅ 'T cell' already available
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | ✅ 'B cell' already available
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Glial cell' already available
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 14:42:26,535 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 0
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 0
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 4
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 5 steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 5 steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    • 0 process_cells steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    • 0 validation steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning |    • 4 analysis steps
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 14:42:26,536 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 14:42:26,537 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:42:26,537 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:26,540 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Compare cell counts for T cells across experimental conditions.
2025-08-26 14:42:26,540 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:42:26,541 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='T cell', kwargs={'cell_type': 'T cell'}
2025-08-26 14:42:26,541 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: T cell
2025-08-26 14:42:26,565 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 14:42:26,566 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:42:26,566 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 14:42:26,566 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:42:26,566 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:42:26,567 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (1/5), skipping post-execution evaluation
2025-08-26 14:42:26,567 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:42:26,567 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:26,567 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 2: Compare cell counts for B cells across experimental conditions.
2025-08-26 14:42:26,568 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:42:26,568 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='B cell', kwargs={'cell_type': 'B cell'}
2025-08-26 14:42:26,568 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: B cell
2025-08-26 14:42:26,593 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 2 completed successfully
2025-08-26 14:42:26,594 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:42:26,594 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 3
2025-08-26 14:42:26,595 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:42:26,595 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:42:26,595 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (2/5), skipping post-execution evaluation
2025-08-26 14:42:26,595 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:42:26,595 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:26,603 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Compare cell counts for Glial cells across experimental conditions.
2025-08-26 14:42:26,604 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:42:26,604 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='Glial cell', kwargs={'cell_type': 'Glial cell'}
2025-08-26 14:42:26,604 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: Glial cell
2025-08-26 14:42:26,621 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/5), skipping post-execution evaluation
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:42:26,623 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:26,624 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Compare cell counts for Epithelial cells across experimental conditions.
2025-08-26 14:42:26,624 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'compare_cell_counts'
2025-08-26 14:42:26,624 | INFO | scchatbot.multi_agent_base | 🔍 compare_cell_counts called with cell_type='Epithelial cell', kwargs={'cell_type': 'Epithelial cell'}
2025-08-26 14:42:26,624 | INFO | scchatbot.multi_agent_base | 🔄 Processing single cell type comparison: Epithelial cell
2025-08-26 14:42:26,641 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: compare_cell_counts - Full data preserved
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (4/5), skipping post-execution evaluation
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 14:42:26,642 | INFO | scchatbot.workflow.node_base |    Current message: Compare the cell counts of each condition for T cell, B cell, Glial cell, and epithelial cell....
2025-08-26 14:42:26,643 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 5: Create a visualization comparing cell counts across conditions for T cell, B cell, Glial cell, and Epithelial cell.
2025-08-26 14:42:26,643 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_cell_count_comparison'
2025-08-26 14:42:26,644 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Handling display_cell_count_comparison - aggregating compare_cell_counts results
2025-08-26 14:42:26,644 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Added data for T cell: dict entries
2025-08-26 14:42:26,644 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Added data for B cell: dict entries
2025-08-26 14:42:26,644 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Added data for Glial cell: dict entries
2025-08-26 14:42:26,644 | INFO | scchatbot.workflow.nodes.execution | 🔍 AGGREGATION: Added data for Epithelial cell: dict entries
2025-08-26 14:42:26,645 | INFO | scchatbot.workflow.nodes.execution | ✅ AGGREGATION: Successfully aggregated data for 4 cell types
2025-08-26 14:42:26,645 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_cell_count_comparison called with kwargs: {'cell_types_data': {'T cell': [{'category': 'cataract', 'cell_count': 205, 'description': 'This is a condition where the lens of the eye becomes cloudy.'}, {'category': 'basal laminar drusen', 'cell_count': 153, 'description': "These are deposits that accumulate between the RPE and Bruch's membrane and are a hallmark of aging and a risk factor for AMD."}, {'category': 'age related macular degeneration', 'cell_count': 177, 'description': 'This is a primary focus of the study as it is a leading cause of irreversible blindness where dysfunction of the RPE and choroid is heavily implicated.'}], 'B cell': [{'category': 'cataract', 'cell_count': 22, 'description': 'This is a condition where the lens of the eye becomes cloudy.'}, {'category': 'basal laminar drusen', 'cell_count': 62, 'description': "These are deposits that accumulate between the RPE and Bruch's membrane and are a hallmark of aging and a risk factor for AMD."}, {'category': 'age related macular degeneration', 'cell_count': 12, 'description': 'This is a primary focus of the study as it is a leading cause of irreversible blindness where dysfunction of the RPE and choroid is heavily implicated.'}], 'Glial cell': [{'category': 'cataract', 'cell_count': 103, 'description': 'This is a condition where the lens of the eye becomes cloudy.'}, {'category': 'basal laminar drusen', 'cell_count': 92, 'description': "These are deposits that accumulate between the RPE and Bruch's membrane and are a hallmark of aging and a risk factor for AMD."}, {'category': 'age related macular degeneration', 'cell_count': 338, 'description': 'This is a primary focus of the study as it is a leading cause of irreversible blindness where dysfunction of the RPE and choroid is heavily implicated.'}], 'Epithelial cell': [{'category': 'cataract', 'cell_count': 375, 'description': 'This is a condition where the lens of the eye becomes cloudy.'}, {'category': 'basal laminar drusen', 'cell_count': 231, 'description': "These are deposits that accumulate between the RPE and Bruch's membrane and are a hallmark of aging and a risk factor for AMD."}, {'category': 'age related macular degeneration', 'cell_count': 527, 'description': 'This is a primary focus of the study as it is a leading cause of irreversible blindness where dysfunction of the RPE and choroid is heavily implicated.'}]}}
2025-08-26 14:42:26,666 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 5 completed successfully
2025-08-26 14:42:26,668 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_cell_count_comparison - HTML preserved
2025-08-26 14:42:26,668 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 6
2025-08-26 14:42:26,668 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 14:42:26,668 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 14:42:26,669 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (5/5), running post-execution evaluation
2025-08-26 14:42:26,669 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:42:26,669 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:42:28,863 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:29,807 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:29,810 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:29,810 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:42:30,370 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:30,373 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:31,231 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 1)
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:42:31,292 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 14:42:32,415 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:32,424 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:32,986 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:32,990 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:32,990 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['compare_cell_counts']
2025-08-26 14:42:32,990 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 14:42:32,991 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:32,991 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: compare_cell_counts (execution 2)
2025-08-26 14:42:32,991 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['compare_cell_counts']
2025-08-26 14:42:32,991 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 14:42:32,991 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Glial cell
2025-08-26 14:42:33,373 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:33,384 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:34,072 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:34,117 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Glial cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Glial cell: ['compare_cell_counts']
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Glial cell' is in unavailable list: []
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Glial cell: compare_cell_counts (execution 3)
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Glial cell: ['compare_cell_counts']
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Glial cell
2025-08-26 14:42:34,118 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 14:42:34,965 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:34,967 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:35,721 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:35,724 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['compare_cell_counts']
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: compare_cell_counts (execution 4)
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['compare_cell_counts']
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:42:35,725 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:42:35,726 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:42:35,726 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 5
2025-08-26 14:42:35,726 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 5
2025-08-26 14:42:35,726 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:42:35,727 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:42:35,727 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:42:35,727 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:42:35,728 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (5/5), running post-execution evaluation
2025-08-26 14:42:35,728 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 14:42:35,728 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 14:42:37,051 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:37,524 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:37,528 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:37,529 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 14:42:38,002 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:38,006 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:38,716 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:38,719 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:38,719 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['compare_cell_counts']
2025-08-26 14:42:38,719 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 14:42:38,720 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:38,720 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: compare_cell_counts (execution 1)
2025-08-26 14:42:38,720 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['compare_cell_counts']
2025-08-26 14:42:38,720 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 14:42:38,720 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 14:42:39,236 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:39,237 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:39,855 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:39,866 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:39,866 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['compare_cell_counts']
2025-08-26 14:42:39,866 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 14:42:39,866 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:39,866 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: compare_cell_counts (execution 2)
2025-08-26 14:42:39,867 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['compare_cell_counts']
2025-08-26 14:42:39,867 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 14:42:39,867 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Glial cell
2025-08-26 14:42:40,434 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:40,443 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:40,897 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Glial cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Glial cell: ['compare_cell_counts']
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Glial cell' is in unavailable list: []
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Glial cell: compare_cell_counts (execution 3)
2025-08-26 14:42:40,899 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Glial cell: ['compare_cell_counts']
2025-08-26 14:42:40,900 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Glial cell
2025-08-26 14:42:40,900 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 14:42:41,431 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:41,440 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: cell_abundance
2025-08-26 14:42:42,147 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:42,156 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["compare_cell_counts"]
```' (length: 35)
2025-08-26 14:42:42,157 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['compare_cell_counts']
2025-08-26 14:42:42,157 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 14:42:42,157 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 14:42:42,157 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: compare_cell_counts (execution 4)
2025-08-26 14:42:42,157 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['compare_cell_counts']
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for cell_abundance question
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 5
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 5
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 14:42:42,158 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 14:42:42,159 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 14:42:42,159 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 5 execution steps
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: compare_cell_counts for T cell
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: compare_cell_counts for B cell
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: compare_cell_counts for Glial cell
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:42:42,160 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: compare_cell_counts for Epithelial cell
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling compare_cell_counts with CellCountResultAccessor
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 5: display_cell_count_comparison for step_4
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 5 function: display_cell_count_comparison
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_types_data': ['T cell', 'B cell', 'Glial cell', 'Epithelial cell']}
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_cell_count_comparison with VisualizationResultAccessor
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 5 successful steps
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 2226 characters for synthesis
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 14:42:42,161 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 14:42:42,162 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (249 chars)
2025-08-26 14:42:42,162 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 14:42:42,162 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 14:42:45,606 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 5 execution steps
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: compare_cell_counts, success=True, has_result=True
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: compare_cell_counts, success=True, has_result=True
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: compare_cell_counts, success=True, has_result=True
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: compare_cell_counts, success=True, has_result=True
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 5: display_cell_count_comparison, success=True, has_result=True
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Cell Count Comparison (11285 chars)
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 11,285 chars)
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 11,285 bytes
2025-08-26 14:42:45,613 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 14:42:45,614 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 14:42:45,614 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 14:42:45,614 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (900 chars)
2025-08-26 14:42:45,662 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 14:42:45,662 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 14:46:36,926 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 14:46:41,604 | INFO | faiss.loader | Loading faiss.
2025-08-26 14:46:41,618 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 14:46:42,316 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 14:46:44,055 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:46:44,108 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 14:46:44,109 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 14:46:44,118 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 14:46:44,625 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:22:25,838 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 15:22:30,864 | INFO | faiss.loader | Loading faiss.
2025-08-26 15:22:30,895 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 15:22:31,698 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:22:33,386 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:22:33,475 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:22:33,476 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:22:33,484 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:22:33,486 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:22:34,733 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:22:34,736 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:22:34,737 | INFO | scchatbot.multi_agent_base | 🧹 Starting cleanup...
2025-08-26 15:22:34,737 | INFO | scchatbot.multi_agent_base | 🧹 Cleared directory: umaps/annotated
2025-08-26 15:22:34,737 | INFO | scchatbot.multi_agent_base | ✅ Cleanup completed
2025-08-26 15:23:05,267 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/multi_agent_base.py changed, reloading.
2025-08-26 15:23:06,613 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 15:23:11,424 | INFO | faiss.loader | Loading faiss.
2025-08-26 15:23:11,439 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 15:23:12,120 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:23:13,749 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:23:13,802 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:23:13,803 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:23:13,811 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:23:14,726 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 15:23:14,727 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 15:23:14,729 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 15:23:25,190 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:23:26,363 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:23:26,367 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:23:35,187 | INFO | scchatbot.multi_agent_base | 🧹 Starting cleanup...
2025-08-26 15:23:35,187 | INFO | scchatbot.multi_agent_base | 🧹 Cleared directory: umaps/annotated
2025-08-26 15:23:35,187 | INFO | scchatbot.multi_agent_base | ✅ Cleanup completed
2025-08-26 15:24:32,143 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 15:24:36,400 | INFO | faiss.loader | Loading faiss.
2025-08-26 15:24:36,415 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 15:24:37,245 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:24:38,940 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:24:38,998 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:24:38,999 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:24:39,013 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:24:39,984 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 15:24:39,984 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 15:24:39,986 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 15:24:58,300 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:25:24,697 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:27:04,874 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:27:05,833 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 15:27:05,833 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 15:27:05,834 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 15:27:06,438 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 15:27:06,438 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 15:27:07,810 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 15:27:07,812 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 15:27:07,812 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 15:29:08,952 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:29:11,976 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:29:14,986 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:29:27,535 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 15:29:27,539 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 15:29:27,539 | INFO | scchatbot.workflow.node_base |    Current message: Find the differential expressive gene from T cell....
2025-08-26 15:29:28,554 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 15:29:28,574 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.node_base |    Current message: Find the differential expressive gene from T cell....
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 15:29:28,575 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Find the differential expressive gene from T cell.'
2025-08-26 15:29:40,283 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:29:41,467 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:29:41,468 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 15:29:41,468 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 15:29:41,468 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 15:29:41,498 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 15:29:41,514 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 15:29:41,515 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 15:29:41,516 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:29:41,516 | INFO | scchatbot.workflow.node_base |    Current message: Find the differential expressive gene from T cell....
2025-08-26 15:29:41,517 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 15:29:41,517 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 15:29:51,298 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:01,031 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:39,328 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:39,333 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 15:30:39,334 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 15:30:39,338 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 15:30:39,361 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 15:30:39,361 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 15:30:39,361 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 15:30:39,362 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 15:30:39,362 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 15:30:39,363 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 15:30:39,363 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 15:30:39,363 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:30:39,363 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 15:30:39,364 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Mast cell', 'Epithelial cell', 'Stromal cell', 'Natural killer cell', 'Mononuclear phagocyte', 'T cell', 'B cell', 'Glial cell']}
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='T cell')
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_dea_heatmap(cell_type='T cell')
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'T cell' not in missing list []
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:30:39,365 | INFO | scchatbot.workflow.node_base |    Current message: Find the differential expressive gene from T cell....
2025-08-26 15:30:39,366 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis to identify genes that are differentially expressed in T cells across different conditions.
2025-08-26 15:30:39,366 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:30:44,270 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 15:30:44,270 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:30:44,270 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 15:30:44,270 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 15:30:44,271 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Create a heatmap visualization of the top differentially expressed genes in T cells.
2025-08-26 15:30:44,271 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 15:30:44,271 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:30:44,863 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 15:30:44,864 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 15:30:44,864 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 15:30:44,864 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 15:30:44,864 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:30:44,865 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 15:30:44,865 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:30:44,865 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:30:46,113 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:46,714 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:46,738 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:30:46,739 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 15:30:47,207 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:47,209 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:30:47,789 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:47,793 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:30:47,793 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 15:30:47,793 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 15:30:47,793 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:30:47,794 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:30:47,795 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 15:30:47,795 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:30:47,795 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:30:48,718 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:49,291 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:49,299 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:30:49,299 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 15:30:49,744 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:49,746 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:30:50,311 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:30:50,319 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:30:50,320 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:30:50,320 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for T cell
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:30:50,321 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'age related macular degeneration', 'basal laminar drusen']
2025-08-26 15:30:50,322 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:30:50,324 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:30:50,326 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:30:50,328 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for T cell
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 8602 characters for synthesis
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 15:30:50,329 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 15:31:02,007 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:31:02,011 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 15:31:02,011 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (9654 chars)
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 9,654 chars)
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 9,654 bytes
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 15:31:02,012 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 15:31:02,013 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 15:31:02,013 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (606 chars)
2025-08-26 15:31:02,162 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 15:31:02,162 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 15:31:29,005 | INFO | scchatbot.multi_agent_base | 🔄 Reusing session state for '36fac317' with 8 available cell types
2025-08-26 15:31:29,007 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 15:31:29,007 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 15:31:29,685 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:31:29,688 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 15:31:29,688 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 15:31:29,689 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removing old context message (56 chars)
2025-08-26 15:31:29,689 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removed 1 old context messages
2025-08-26 15:31:29,689 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 15:31:29,689 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 8 cell types: ['Mast cell', 'Epithelial cell', 'Stromal cell', 'Natural killer cell', 'Mononuclear phagocyte', 'T cell', 'B cell', 'Glial cell']
2025-08-26 15:31:29,689 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 250 chars, starts with: 'Cell types currently available in the dataset:
  •...'
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (250 chars)
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'Cell types currently available in the dataset:
  • B cell
  • Epithelial cell
  • Glial cell
  • Mas...'
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (273 chars)
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Preserving 8 discovered cell types from previous operations
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.nodes.input_processing |    Preserved types: ['B cell', 'Epithelial cell', 'Glial cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Stromal cell', 'T cell']
2025-08-26 15:31:29,690 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 15:31:29,692 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 15:31:29,692 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 15:31:29,692 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 15:31:29,693 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 15:31:29,693 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 8
2025-08-26 15:31:29,693 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 4
2025-08-26 15:31:29,693 | INFO | scchatbot.workflow.nodes.planning |    • New types discovered: B cell, Mast cell, Mononuclear phagocyte, Natural killer cell, T cell
2025-08-26 15:31:29,693 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'What are the cell types we get right now?'
2025-08-26 15:31:32,595 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:31:33,922 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:31:33,940 | INFO | scchatbot.workflow.nodes.planning | 🔍 No specific cell types identified in question
2025-08-26 15:31:33,940 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 15:31:33,940 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 1 steps
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 1 steps
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.nodes.planning |    • 0 process_cells steps
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.nodes.planning |    • 0 validation steps
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.nodes.planning |    • 0 analysis steps
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 15:31:33,941 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 15:31:33,942 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:31:33,942 | INFO | scchatbot.workflow.node_base |    Current message: What are the cell types we get right now?...
2025-08-26 15:31:33,943 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Respond to the user's query by listing the currently available cell types.
2025-08-26 15:31:33,943 | INFO | scchatbot.workflow.nodes.execution | ℹ️ No function for this step; treating as direct-answer/no-op.
2025-08-26 15:31:33,943 | INFO | scchatbot.workflow.nodes.execution | 📄 Text storage: direct_answer - Truncated to 500 chars
2025-08-26 15:31:33,943 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 15:31:33,943 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.evaluation | ℹ️ Evaluator: no callable steps in plan; skipping post-execution evaluation.
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.evaluation | ℹ️ Evaluator: no callable steps in plan; skipping post-execution evaluation.
2025-08-26 15:31:33,944 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 1 execution steps
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: direct_answer for step_0
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.unified_result_accessor | ⚠️ No accessor found for function: direct_answer
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 1 successful steps
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 64 characters for synthesis
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 15:31:33,944 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (273 chars)
2025-08-26 15:31:33,945 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 15:31:33,945 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 15:31:35,110 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:31:35,115 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 1 execution steps
2025-08-26 15:31:35,115 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: direct_answer, success=True, has_result=True
2025-08-26 15:31:35,115 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: No valid plots found
2025-08-26 15:31:35,115 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 0 individual plots
2025-08-26 15:31:35,115 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (355 chars)
2025-08-26 15:31:35,151 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 15:31:35,151 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 15:32:13,338 | INFO | scchatbot.multi_agent_base | 🔄 Reusing session state for '36fac317' with 8 available cell types
2025-08-26 15:32:13,342 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 15:32:13,342 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:14,391 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:14,399 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removing old context message (273 chars)
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removed 1 old context messages
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 8 cell types: ['Mast cell', 'Epithelial cell', 'Stromal cell', 'Natural killer cell', 'Mononuclear phagocyte', 'T cell', 'B cell', 'Glial cell']
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 226 chars, starts with: 'Cell types currently available in the dataset:
  •...'
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (226 chars)
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'Cell types currently available in the dataset:
  • B cell
  • Epithelial cell
  • Glial cell
  • Mas...'
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (249 chars)
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Preserving 8 discovered cell types from previous operations
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.nodes.input_processing |    Preserved types: ['B cell', 'Epithelial cell', 'Glial cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Stromal cell', 'T cell']
2025-08-26 15:32:14,400 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 8
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 4
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning |    • New types discovered: B cell, Mast cell, Mononuclear phagocyte, Natural killer cell, T cell
2025-08-26 15:32:14,401 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to B cell, epithelial cell, and mast cell.'
2025-08-26 15:32:21,125 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:23,156 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:23,163 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['B cell', 'Epithelial cell', 'Mast cell']
2025-08-26 15:32:23,163 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Mast cell', 'Epithelial cell', 'Stromal cell', 'Natural killer cell', 'Mononuclear phagocyte', 'T cell', 'B cell', 'Glial cell']
2025-08-26 15:32:23,164 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(B cell)
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(Epithelial cell)
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(Mast cell)
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | ✅ 'B cell' already available
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Mast cell' already available
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 0
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 0
2025-08-26 15:32:23,165 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 3
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 3
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 6 steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 6 steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning |    • 0 process_cells steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning |    • 0 validation steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.nodes.planning |    • 3 analysis steps
2025-08-26 15:32:23,166 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 15:32:23,167 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 15:32:23,168 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:23,168 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:23,169 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Perform DEA to identify differentially expressed genes in B cells across conditions.
2025-08-26 15:32:23,169 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:32:28,293 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (1/6), skipping post-execution evaluation
2025-08-26 15:32:28,294 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:28,295 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:28,295 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 2: Perform DEA to identify differentially expressed genes in Epithelial cells across conditions.
2025-08-26 15:32:28,295 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:32:33,324 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 2 completed successfully
2025-08-26 15:32:33,325 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:32:33,325 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 3
2025-08-26 15:32:33,325 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:33,325 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:33,325 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (2/6), skipping post-execution evaluation
2025-08-26 15:32:33,326 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:33,326 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:33,326 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform DEA to identify differentially expressed genes in Mast cells across conditions.
2025-08-26 15:32:33,326 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:32:38,452 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 15:32:38,454 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:32:38,454 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 15:32:38,454 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:38,454 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:38,455 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/6), skipping post-execution evaluation
2025-08-26 15:32:38,455 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:38,455 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:38,455 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Visualize the DEA results for B cells using a heatmap to show gene expression patterns.
2025-08-26 15:32:38,455 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 15:32:38,455 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'B cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:38,482 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 15:32:38,483 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 15:32:38,483 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 15:32:38,483 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:38,483 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:38,484 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (4/6), skipping post-execution evaluation
2025-08-26 15:32:38,484 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:38,484 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:38,484 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 5: Visualize the DEA results for Epithelial cells using a heatmap to show gene expression patterns.
2025-08-26 15:32:38,484 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 15:32:38,485 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:38,496 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 5 completed successfully
2025-08-26 15:32:38,497 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 15:32:38,497 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 6
2025-08-26 15:32:38,497 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:38,497 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:38,498 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (5/6), skipping post-execution evaluation
2025-08-26 15:32:38,498 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:32:38,498 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:32:38,498 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 6: Visualize the DEA results for Mast cells using a heatmap to show gene expression patterns.
2025-08-26 15:32:38,498 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 15:32:38,499 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'Mast cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:38,508 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 6 completed successfully
2025-08-26 15:32:38,509 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 15:32:38,509 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 7
2025-08-26 15:32:38,509 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:32:38,509 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:32:38,509 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 15:32:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:32:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:32:40,037 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:40,594 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:40,595 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:40,595 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 15:32:41,277 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:41,298 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:43,026 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 1)
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: display_dea_heatmap (execution 4)
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 15:32:43,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 15:32:43,591 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:43,592 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:44,311 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 2)
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 15:32:44,331 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 15:32:45,277 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:45,278 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:46,352 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:46,512 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:46,512 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 15:32:46,512 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 15:32:46,512 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 3)
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: display_dea_heatmap (execution 6)
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:32:46,513 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:32:46,514 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 15:32:46,514 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:32:46,514 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:32:48,349 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:48,956 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:48,968 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:48,968 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 15:32:50,294 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:50,295 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:51,023 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:51,025 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 1)
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: display_dea_heatmap (execution 4)
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 15:32:51,026 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 15:32:51,627 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:51,629 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:52,650 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:52,653 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:52,653 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 2)
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 15:32:52,654 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 15:32:53,190 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:53,196 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:32:53,740 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:32:53,743 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 3)
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: display_dea_heatmap (execution 6)
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 15:32:53,744 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:32:53,745 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:32:53,747 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 15:32:53,748 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 15:32:53,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 6 execution steps
2025-08-26 15:32:53,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: dea_split_by_condition for B cell
2025-08-26 15:32:53,748 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:32:53,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'age related macular degeneration', 'basal laminar drusen']
2025-08-26 15:32:53,751 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,755 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,756 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,758 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,759 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: dea_split_by_condition for Epithelial cell
2025-08-26 15:32:53,759 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:32:53,759 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'age related macular degeneration', 'basal laminar drusen']
2025-08-26 15:32:53,759 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,763 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,766 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,769 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,770 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for Mast cell
2025-08-26 15:32:53,771 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:32:53,771 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'age related macular degeneration', 'basal laminar drusen']
2025-08-26 15:32:53,771 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,775 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,778 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,781 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for B cell
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'B cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 5: display_dea_heatmap for Epithelial cell
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 5 function: display_dea_heatmap
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 15:32:53,782 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 6: display_dea_heatmap for Mast cell
2025-08-26 15:32:53,783 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 6 function: display_dea_heatmap
2025-08-26 15:32:53,783 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'Mast cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:32:53,783 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 15:32:53,783 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 6 successful steps
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 25417 characters for synthesis
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (249 chars)
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 15:32:53,784 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 15:33:13,399 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 6 execution steps
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 15:33:13,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - B cell (9686 chars)
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 5: display_dea_heatmap, success=True, has_result=True
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Skipping display_dea_heatmap - duplicate plot detected
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 6: display_dea_heatmap, success=True, has_result=True
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Skipping display_dea_heatmap - duplicate plot detected
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 9,686 chars)
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 9,686 bytes
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 15:33:13,404 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 15:33:13,405 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1461 chars)
2025-08-26 15:33:13,460 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 15:33:13,460 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 15:44:17,117 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 15:44:22,178 | INFO | faiss.loader | Loading faiss.
2025-08-26 15:44:22,208 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 15:44:22,934 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:44:24,600 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:44:24,674 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:44:24,674 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:44:24,682 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:44:25,651 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 15:44:25,651 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 15:44:25,654 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 15:44:40,367 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:45:01,900 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:46:20,597 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:46:21,731 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 15:46:21,731 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 15:46:21,731 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 15:46:22,342 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 15:46:22,342 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 15:46:23,737 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 15:46:23,739 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 15:46:23,739 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 15:47:24,071 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:47:27,996 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:47:31,004 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:47:32,306 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 15:47:32,307 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 15:47:32,307 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:47:32,927 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:47:32,933 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 15:47:32,935 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 15:47:32,935 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 15:47:32,936 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 15:47:32,936 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 15:47:32,936 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 15:47:32,936 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 15:47:32,937 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 15:47:32,937 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 15:47:32,937 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 15:47:32,938 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 15:47:32,939 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to B cell, epithelial cell, and mast cell.'
2025-08-26 15:47:49,788 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:47:51,972 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:47:51,989 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['B cell', 'Epithelial cell', 'Mast cell']
2025-08-26 15:47:51,989 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 15:47:51,989 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(Epithelial cell)
2025-08-26 15:47:52,016 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available
2025-08-26 15:47:52,032 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 15:47:52,045 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'B cell': Immune cell → B cell
2025-08-26 15:47:52,045 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available, no discovery needed
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'Mast cell': Immune cell → Mast cell
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['B cell', 'Mast cell']
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(B cell)
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(Mast cell)
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['B cell', 'Mast cell']
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 15:47:52,060 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 2
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: -1 steps for undiscoverable types
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 5 steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 5 steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning |    • 3 analysis steps
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 15:47:52,061 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:47:52,062 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:47:52,063 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover B cell, Mast cell
2025-08-26 15:47:52,063 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 15:47:58,236 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:48:08,309 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:48:49,829 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:48:49,832 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 15:48:49,833 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 15:48:49,833 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 15:48:49,859 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 15:48:49,859 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 15:48:49,860 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 15:48:49,860 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 15:48:49,860 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 15:48:49,861 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 15:48:49,862 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['B cell', 'Mast cell']...
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'B cell'
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'Mast cell'
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 2 expected cell types found successfully
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['B cell', 'Mast cell'], found=['B cell', 'Mast cell'], missing=[]
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 2 expected cell types found successfully', 'found_children': ['B cell', 'Mast cell'], 'missing_children': [], 'available_types': ['T cell', 'Epithelial cell', 'Glial cell', 'Natural killer cell', 'Mast cell', 'Stromal cell', 'Mononuclear phagocyte', 'B cell']}
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 3 remaining steps...
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='B cell')
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'B cell' not in missing list []
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: dea_split_by_condition(cell_type='Mast cell')
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'Mast cell' not in missing list []
2025-08-26 15:48:49,863 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5: display_dea_heatmap(cell_type='Epithelial cell')
2025-08-26 15:48:49,864 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5 cell type 'Epithelial cell' not in missing list []
2025-08-26 15:48:49,864 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 15:48:49,864 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:48:49,864 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:48:49,865 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for epithelial cells to identify differentially expressed genes between conditions.
2025-08-26 15:48:49,865 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:48:54,719 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 15:48:54,719 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/5), skipping post-execution evaluation
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:48:54,720 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:48:54,721 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Perform differential expression analysis for epithelial cells to identify differentially expressed genes between conditions.
2025-08-26 15:48:54,721 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:48:59,772 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 15:48:59,773 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:48:59,773 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 15:48:59,773 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:48:59,773 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:48:59,774 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (4/5), skipping post-execution evaluation
2025-08-26 15:48:59,774 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:48:59,774 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:48:59,774 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 5: Create a heatmap visualization of the top differentially expressed genes for epithelial cells.
2025-08-26 15:48:59,774 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 15:48:59,775 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:48:59,775 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 5 completed successfully
2025-08-26 15:48:59,775 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 15:48:59,775 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 6
2025-08-26 15:48:59,775 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:48:59,776 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:48:59,776 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (5/5), running post-execution evaluation
2025-08-26 15:48:59,776 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:48:59,776 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:49:01,610 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:02,186 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:02,192 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:02,192 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 15:49:02,905 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:02,906 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:04,167 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:04,168 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 15:49:04,169 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 15:49:04,643 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:04,644 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:05,207 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap']
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(Epithelial cell)
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for Epithelial cell
2025-08-26 15:49:05,209 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 15:49:05,993 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:05,994 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:06,785 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 5
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 5
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:49:06,791 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:49:06,792 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:49:06,792 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:49:06,792 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 6: Post-evaluation: dea_split_by_condition for Epithelial cell
2025-08-26 15:49:06,793 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 15:49:11,649 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 6 completed successfully
2025-08-26 15:49:11,650 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 15:49:11,650 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 7
2025-08-26 15:49:11,650 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 15:49:11,650 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 15:49:11,651 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 15:49:11,651 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:49:11,651 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:49:13,391 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:13,911 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:13,921 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:13,921 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 15:49:14,389 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:14,397 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:15,374 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:15,382 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:15,382 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 15:49:15,382 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 15:49:15,382 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:15,383 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 15:49:15,383 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 15:49:15,383 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 15:49:15,383 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 15:49:15,928 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:15,937 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:16,619 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 15:49:16,620 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 15:49:17,133 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:17,145 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:17,734 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:17,736 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:17,736 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:17,736 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 15:49:17,736 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:17,736 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:49:17,737 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:49:17,738 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 15:49:17,738 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 15:49:17,738 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 15:49:19,204 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:19,789 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:19,805 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:19,805 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 15:49:20,337 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:20,346 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:21,027 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:21,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:21,027 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 15:49:21,027 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 15:49:21,028 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:21,028 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 15:49:21,028 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 15:49:21,028 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 15:49:21,028 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 15:49:22,085 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:22,087 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:22,676 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:22,679 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 15:49:22,680 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 15:49:23,355 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:23,362 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 15:49:24,068 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:24,078 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 15:49:24,079 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 15:49:24,079 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 6 execution steps
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for B cell
2025-08-26 15:49:24,080 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:49:24,082 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'age related macular degeneration', 'cataract', 'basal laminar drusen']
2025-08-26 15:49:24,083 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,087 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,090 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,093 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,095 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for Mast cell
2025-08-26 15:49:24,095 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:49:24,095 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'age related macular degeneration', 'cataract', 'basal laminar drusen']
2025-08-26 15:49:24,097 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,101 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,104 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,107 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 5: display_dea_heatmap for Epithelial cell
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 5 function: display_dea_heatmap
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 6: dea_split_by_condition for Epithelial cell
2025-08-26 15:49:24,108 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 15:49:24,109 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'age related macular degeneration', 'cataract', 'basal laminar drusen']
2025-08-26 15:49:24,110 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,113 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,114 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,117 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 15:49:24,118 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 6 successful steps
2025-08-26 15:49:24,119 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 25332 characters for synthesis
2025-08-26 15:49:24,120 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 15:49:24,120 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 15:49:24,120 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 15:49:24,120 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 15:49:24,120 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 15:49:39,615 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:49:39,618 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 6 execution steps
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 5: display_dea_heatmap, success=True, has_result=True
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - Epithelial cell (108 chars)
2025-08-26 15:49:39,619 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 6: dea_split_by_condition, success=True, has_result=True
2025-08-26 15:49:39,620 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 108 chars)
2025-08-26 15:49:39,620 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 108 bytes
2025-08-26 15:49:39,620 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 15:49:39,620 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 15:49:39,621 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 15:49:39,621 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1278 chars)
2025-08-26 15:49:39,742 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 15:49:39,742 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 15:55:03,028 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 15:55:07,708 | INFO | faiss.loader | Loading faiss.
2025-08-26 15:55:07,722 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 15:55:08,477 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 15:55:10,160 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:55:10,209 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 15:55:10,210 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 15:55:10,218 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 15:55:11,109 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 15:55:11,110 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 15:55:11,111 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 15:55:33,226 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:55:39,938 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:59:18,921 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:59:20,017 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 15:59:20,017 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 15:59:20,017 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 15:59:20,629 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 15:59:20,630 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 15:59:22,190 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 15:59:22,193 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 15:59:22,193 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 15:59:31,572 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:59:34,594 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:59:36,116 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 15:59:36,117 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 15:59:36,117 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:59:36,984 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:59:36,987 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 15:59:36,988 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 15:59:36,989 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 15:59:36,990 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 15:59:36,990 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 15:59:36,995 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to B cell, epithelial cell, and mast cell.'
2025-08-26 15:59:37,612 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 15:59:44,766 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:59:46,024 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 15:59:46,026 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['B cell', 'Epithelial cell', 'Mast cell']
2025-08-26 15:59:46,026 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 15:59:46,026 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(Epithelial cell)
2025-08-26 15:59:46,052 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available
2025-08-26 15:59:46,069 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 15:59:46,082 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'B cell': Immune cell → B cell
2025-08-26 15:59:46,082 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available, no discovery needed
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'Mast cell': Immune cell → Mast cell
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['B cell', 'Mast cell']
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(B cell)
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(Mast cell)
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['B cell', 'Mast cell']
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 2
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: -1 steps for undiscoverable types
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 15:59:46,098 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 5 steps
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 5 steps
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.nodes.planning |    • 3 analysis steps
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 15:59:46,099 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 15:59:46,100 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover B cell, Mast cell
2025-08-26 15:59:46,100 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 15:59:52,372 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:00:04,432 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:11,870 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:11,873 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:01:11,873 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 16:01:11,873 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 16:01:11,893 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 16:01:11,893 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 16:01:11,894 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 16:01:11,894 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 16:01:11,894 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 16:01:11,895 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 16:01:11,896 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:01:11,896 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:01:11,896 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:01:11,896 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 16:01:11,897 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 16:01:11,897 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['B cell', 'Mast cell']...
2025-08-26 16:01:11,897 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'B cell'
2025-08-26 16:01:11,897 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'Mast cell'
2025-08-26 16:01:11,897 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 2 expected cell types found successfully
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['B cell', 'Mast cell'], found=['B cell', 'Mast cell'], missing=[]
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 2 expected cell types found successfully', 'found_children': ['B cell', 'Mast cell'], 'missing_children': [], 'available_types': ['Stromal cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Epithelial cell', 'B cell', 'T cell', 'Mast cell', 'Glial cell']}
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 3 remaining steps...
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='B cell')
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'B cell' not in missing list []
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: dea_split_by_condition(cell_type='Mast cell')
2025-08-26 16:01:11,898 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'Mast cell' not in missing list []
2025-08-26 16:01:11,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5: display_dea_heatmap(cell_type='Epithelial cell')
2025-08-26 16:01:11,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5 cell type 'Epithelial cell' not in missing list []
2025-08-26 16:01:11,899 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 16:01:11,899 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:01:11,899 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:01:11,900 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for epithelial cells to identify differentially expressed genes.
2025-08-26 16:01:11,900 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:01:16,745 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 16:01:16,746 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:01:16,746 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 16:01:16,746 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:01:16,746 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:01:16,747 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/5), skipping post-execution evaluation
2025-08-26 16:01:16,747 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:01:16,747 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:01:16,747 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Perform differential expression analysis for epithelial cells to identify differentially expressed genes.
2025-08-26 16:01:16,747 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:01:21,691 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (4/5), skipping post-execution evaluation
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:01:21,693 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:01:21,694 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 5: Create a heatmap visualization of the top differentially expressed genes for epithelial cells.
2025-08-26 16:01:21,694 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:01:21,694 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:01:21,695 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 5 completed successfully
2025-08-26 16:01:21,695 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:01:21,695 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 6
2025-08-26 16:01:21,695 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:01:21,696 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:01:21,696 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (5/5), running post-execution evaluation
2025-08-26 16:01:21,696 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:01:21,696 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:01:23,358 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:24,506 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:24,523 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:24,523 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:01:25,090 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:25,095 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:25,757 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:25,757 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:25,757 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:01:25,757 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:01:25,758 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:01:25,758 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:01:25,758 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:01:25,758 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:01:25,758 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:01:26,409 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:26,410 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:27,167 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap']
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(Epithelial cell)
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for Epithelial cell
2025-08-26 16:01:27,224 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:01:28,024 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:28,028 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:28,595 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:28,597 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:28,598 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:28,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:01:28,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:01:28,598 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:01:28,599 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 5
2025-08-26 16:01:28,600 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 5
2025-08-26 16:01:28,601 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:01:28,601 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-08-26 16:01:28,601 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:01:28,601 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:01:28,602 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:01:28,602 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:01:28,603 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 6: Post-evaluation: dea_split_by_condition for Epithelial cell
2025-08-26 16:01:28,603 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:01:33,463 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 6 completed successfully
2025-08-26 16:01:33,464 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:01:33,464 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 7
2025-08-26 16:01:33,464 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:01:33,464 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:01:33,465 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 16:01:33,465 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:01:33,465 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:01:34,963 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:35,870 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:35,871 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:35,871 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:01:36,486 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:36,487 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:37,379 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:01:37,380 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:01:37,982 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:37,983 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:39,020 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:39,024 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 16:01:39,025 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 16:01:39,026 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:01:39,642 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:39,643 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:40,793 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:01:40,794 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:01:40,795 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 16:01:40,795 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:01:40,795 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:01:42,086 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:43,922 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:43,925 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:43,926 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:01:44,572 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:44,578 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:45,645 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:01:45,648 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:01:46,318 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:46,321 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:47,010 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:47,013 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:47,013 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 16:01:47,014 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:01:47,783 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:47,784 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:01:48,365 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:01:48,368 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:01:48,369 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:01:48,370 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:01:48,371 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:01:48,371 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:01:48,372 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:01:48,372 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 6 execution steps
2025-08-26 16:01:48,372 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 16:01:48,372 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 16:01:48,372 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 16:01:48,373 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 16:01:48,373 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for B cell
2025-08-26 16:01:48,373 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:01:48,373 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'basal laminar drusen', 'age related macular degeneration', 'cataract']
2025-08-26 16:01:48,376 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,381 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,384 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,388 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,390 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for Mast cell
2025-08-26 16:01:48,391 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:01:48,391 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'basal laminar drusen', 'age related macular degeneration', 'cataract']
2025-08-26 16:01:48,392 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,395 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,398 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,401 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 5: display_dea_heatmap for Epithelial cell
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 5 function: display_dea_heatmap
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 6: dea_split_by_condition for Epithelial cell
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:01:48,403 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'basal laminar drusen', 'age related macular degeneration', 'cataract']
2025-08-26 16:01:48,404 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,407 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,409 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,411 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:01:48,412 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 6 successful steps
2025-08-26 16:01:48,413 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 25332 characters for synthesis
2025-08-26 16:01:48,413 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:01:48,413 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:01:48,414 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 16:01:48,414 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:01:48,414 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:02:09,360 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:02:09,364 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 6 execution steps
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 5: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - Epithelial cell (108 chars)
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 6: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:02:09,365 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 108 chars)
2025-08-26 16:02:09,366 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 108 bytes
2025-08-26 16:02:09,366 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:02:09,366 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:02:09,366 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:02:09,366 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1681 chars)
2025-08-26 16:02:09,466 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:02:09,466 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:05:12,294 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/workflow/nodes/planning.py changed, reloading.
2025-08-26 16:05:14,593 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:05:19,372 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:05:19,389 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:05:20,153 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:05:22,254 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:05:22,297 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:05:22,297 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:05:22,306 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:05:23,196 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:05:23,197 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:05:23,198 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:05:38,412 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:05:44,910 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:06:01,043 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:06:02,614 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:06:06,733 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:06:06,747 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:06:07,416 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:06:09,105 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:06:09,146 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:06:09,146 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:06:09,155 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:06:09,974 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:06:09,974 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:06:09,976 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:06:22,720 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:06:27,094 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:08,496 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:09,476 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 16:07:09,477 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 16:07:09,477 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 16:07:10,138 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 16:07:10,138 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 16:07:11,434 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 16:07:11,438 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 16:07:11,438 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 16:07:19,929 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:07:23,022 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:07:25,339 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 16:07:25,345 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 16:07:25,346 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:07:25,837 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:25,846 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 16:07:25,846 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 16:07:25,846 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 16:07:25,847 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to B cell, epithelial cell, and mast cell.'
2025-08-26 16:07:26,033 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:07:34,773 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:36,449 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:36,454 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['B cell', 'Epithelial cell', 'Mast cell']
2025-08-26 16:07:36,454 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 16:07:36,454 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(Epithelial cell)
2025-08-26 16:07:36,481 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available
2025-08-26 16:07:36,492 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 16:07:36,508 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'B cell': Immune cell → B cell
2025-08-26 16:07:36,509 | INFO | scchatbot.workflow.nodes.planning | ✅ 'Epithelial cell' already available, no discovery needed
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'Mast cell': Immune cell → Mast cell
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['B cell', 'Mast cell']
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(B cell)
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🔄 Updated analysis step: dea_split_by_condition(Epithelial cell) → dea_split_by_condition(Mast cell)
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['B cell', 'Mast cell']
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 2
2025-08-26 16:07:36,525 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: -1 steps for undiscoverable types
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 5 steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 5 steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning |    • 3 analysis steps
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:07:36,526 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:07:36,527 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover B cell, Mast cell
2025-08-26 16:07:36,527 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 16:07:39,610 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:07:42,507 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:12,432 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:12,439 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:08:12,439 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 16:08:12,441 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 16:08:12,471 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 16:08:12,471 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 16:08:12,471 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 16:08:12,471 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 16:08:12,471 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 16:08:12,473 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 16:08:12,473 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:08:12,473 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:08:12,473 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['B cell', 'Mast cell']...
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'B cell'
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'Mast cell'
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 2 expected cell types found successfully
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['B cell', 'Mast cell'], found=['B cell', 'Mast cell'], missing=[]
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 2 expected cell types found successfully', 'found_children': ['B cell', 'Mast cell'], 'missing_children': [], 'available_types': ['Stromal cell', 'Natural killer cell', 'Epithelial cell', 'B cell', 'Mast cell', 'T cell', 'Glial cell', 'Mononuclear phagocyte']}
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 3 remaining steps...
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='B cell')
2025-08-26 16:08:12,474 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'B cell' not in missing list []
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: dea_split_by_condition(cell_type='Mast cell')
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'Mast cell' not in missing list []
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5: display_dea_heatmap(cell_type='Epithelial cell')
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 5 cell type 'Epithelial cell' not in missing list []
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:08:12,475 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:08:12,476 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for epithelial cells to identify differentially expressed genes between conditions.
2025-08-26 16:08:12,476 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:08:17,459 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 16:08:17,459 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (3/5), skipping post-execution evaluation
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:08:17,460 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Perform differential expression analysis for epithelial cells to identify differentially expressed genes between conditions.
2025-08-26 16:08:17,461 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:08:22,509 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 16:08:22,510 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:08:22,510 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 16:08:22,511 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:08:22,511 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:08:22,511 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Steps still remaining (4/5), skipping post-execution evaluation
2025-08-26 16:08:22,511 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:08:22,511 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:08:22,512 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 5: Create a heatmap visualization of the top differentially expressed genes for epithelial cells.
2025-08-26 16:08:22,512 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:08:22,512 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:08:22,512 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 5 completed successfully
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 6
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (5/5), running post-execution evaluation
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:08:22,513 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:08:25,240 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:25,951 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:25,968 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:25,968 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:08:26,645 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:26,646 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:27,273 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:08:27,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:08:27,799 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:27,807 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:28,517 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap']
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(Epithelial cell)
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for Epithelial cell
2025-08-26 16:08:28,518 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:08:29,048 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:29,059 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:29,904 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 5 entries
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-08-26 16:08:29,905 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 5
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 5
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:08:29,906 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:08:29,907 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:08:29,907 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to B cell, epithelial cell, and mast cell....
2025-08-26 16:08:29,908 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 6: Post-evaluation: dea_split_by_condition for Epithelial cell
2025-08-26 16:08:29,908 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:08:34,854 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 6 completed successfully
2025-08-26 16:08:34,855 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:08:34,855 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 7
2025-08-26 16:08:34,855 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:08:34,855 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:08:34,856 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 16:08:34,856 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:08:34,856 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:08:36,396 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:36,995 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:37,008 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:37,008 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:08:37,470 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:37,478 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:38,180 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:08:38,187 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:08:38,188 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:08:38,188 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:08:40,014 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:40,019 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:40,682 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 16:08:40,684 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:08:41,173 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:41,176 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:41,825 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:08:41,826 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:08:41,827 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (6/6), running post-execution evaluation
2025-08-26 16:08:41,827 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:08:41,827 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:08:43,604 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:44,045 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:44,047 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:44,047 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: B cell
2025-08-26 16:08:44,617 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:44,622 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:45,315 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:45,318 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for B cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:45,318 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for B cell: ['dea_split_by_condition']
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'B cell' is in unavailable list: []
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for B cell: dea_split_by_condition (execution 3)
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for B cell: ['dea_split_by_condition']
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for B cell
2025-08-26 16:08:45,319 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Epithelial cell
2025-08-26 16:08:47,736 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:47,740 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:48,440 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Epithelial cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Epithelial cell: ['dea_split_by_condition']
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Epithelial cell' is in unavailable list: []
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: display_dea_heatmap (execution 5)
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Epithelial cell: dea_split_by_condition (execution 6)
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Epithelial cell: ['display_dea_heatmap', 'dea_split_by_condition']
2025-08-26 16:08:48,443 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Epithelial cell
2025-08-26 16:08:48,444 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: Mast cell
2025-08-26 16:08:49,033 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:49,034 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:08:49,672 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for Mast cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'Mast cell' is in unavailable list: []
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 6 entries
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for Mast cell: dea_split_by_condition (execution 4)
2025-08-26 16:08:49,675 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for Mast cell: ['dea_split_by_condition']
2025-08-26 16:08:49,676 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for Mast cell
2025-08-26 16:08:49,676 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:08:49,676 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 6
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 6
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:08:49,677 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:08:49,678 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:08:49,680 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:08:49,680 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 6 execution steps
2025-08-26 16:08:49,680 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 16:08:49,680 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 16:08:49,680 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 16:08:49,681 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 16:08:49,681 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for B cell
2025-08-26 16:08:49,681 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:08:49,681 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'bulk', 'cataract', 'age related macular degeneration']
2025-08-26 16:08:49,685 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,690 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,694 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,697 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,699 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for Mast cell
2025-08-26 16:08:49,699 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:08:49,699 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'bulk', 'cataract', 'age related macular degeneration']
2025-08-26 16:08:49,701 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,704 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,707 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,710 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 5: display_dea_heatmap for Epithelial cell
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 5 function: display_dea_heatmap
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'Epithelial cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 6: dea_split_by_condition for Epithelial cell
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:08:49,712 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'bulk', 'cataract', 'age related macular degeneration']
2025-08-26 16:08:49,713 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,715 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,716 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,718 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:08:49,720 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 6 successful steps
2025-08-26 16:08:49,720 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 25332 characters for synthesis
2025-08-26 16:08:49,721 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:08:49,721 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:08:49,721 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 16:08:49,721 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:08:49,721 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:09:03,660 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:09:03,663 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 6 execution steps
2025-08-26 16:09:03,664 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 16:09:03,664 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 16:09:03,664 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:09:03,664 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 5: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - Epithelial cell (108 chars)
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 6: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 108 chars)
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 108 bytes
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:09:03,665 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:09:03,666 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1629 chars)
2025-08-26 16:09:03,753 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:09:03,753 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:12:52,566 | INFO | scchatbot.multi_agent_base | 🔄 Reusing session state for '36fac317' with 8 available cell types
2025-08-26 16:12:52,569 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 16:12:52,570 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:12:53,459 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:12:53,460 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removing old context message (56 chars)
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | 🧹 CONTEXT CLEANUP: Removed 1 old context messages
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 8 cell types: ['Stromal cell', 'Natural killer cell', 'Epithelial cell', 'B cell', 'Mast cell', 'T cell', 'Glial cell', 'Mononuclear phagocyte']
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 250 chars, starts with: 'Cell types currently available in the dataset:
  •...'
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (250 chars)
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'Cell types currently available in the dataset:
  • B cell
  • Epithelial cell
  • Glial cell
  • Mas...'
2025-08-26 16:12:53,461 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (273 chars)
2025-08-26 16:12:53,462 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Preserving 8 discovered cell types from previous operations
2025-08-26 16:12:53,462 | INFO | scchatbot.workflow.nodes.input_processing |    Preserved types: ['B cell', 'Epithelial cell', 'Glial cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Stromal cell', 'T cell']
2025-08-26 16:12:53,462 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 8
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 4
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning |    • New types discovered: B cell, Mast cell, Mononuclear phagocyte, Natural killer cell, T cell
2025-08-26 16:12:53,463 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to T cell.'
2025-08-26 16:12:56,361 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:12:57,894 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:12:57,897 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 16:12:57,897 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Stromal cell', 'Natural killer cell', 'Epithelial cell', 'B cell', 'Mast cell', 'T cell', 'Glial cell', 'Mononuclear phagocyte']
2025-08-26 16:12:57,897 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 16:12:57,898 | INFO | scchatbot.workflow.nodes.planning | ✅ 'T cell' already available
2025-08-26 16:12:57,898 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 16:12:57,898 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 0
2025-08-26 16:12:57,898 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 0
2025-08-26 16:12:57,899 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 16:12:57,899 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 16:12:57,899 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 16:12:57,899 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 16:12:57,899 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 2 steps
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 2 steps
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.nodes.planning |    • 0 process_cells steps
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.nodes.planning |    • 0 validation steps
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 16:12:57,900 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 16:12:57,901 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:12:57,901 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:12:57,904 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Perform differential expression analysis for T cells to identify differentially expressed genes between conditions.
2025-08-26 16:12:57,904 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:13:02,897 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:13:02,898 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:13:02,898 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:13:02,898 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 16:13:02,898 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 2: Create a heatmap visualization of the top differentially expressed genes for T cells.
2025-08-26 16:13:02,898 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:13:02,898 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:13:03,589 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 2 completed successfully
2025-08-26 16:13:03,590 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:13:03,590 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 3
2025-08-26 16:13:03,590 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 16:13:03,590 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:13:03,591 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (2/2), running post-execution evaluation
2025-08-26 16:13:03,591 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:13:03,591 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:13:05,244 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:05,910 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:05,912 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:13:05,912 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:13:07,100 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:07,101 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:13:07,843 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:07,850 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 2 entries
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 1)
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 2)
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:13:07,851 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 2
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 2
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:13:07,852 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:13:07,853 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (2/2), running post-execution evaluation
2025-08-26 16:13:07,853 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:13:07,853 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:13:09,268 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:09,976 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:09,978 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:13:09,978 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:13:10,525 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:10,527 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:13:11,178 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:11,181 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:13:11,181 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 2 entries
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 1)
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 2)
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:13:11,182 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 2
2025-08-26 16:13:11,183 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 2
2025-08-26 16:13:11,183 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:13:11,183 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:13:11,184 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:13:11,184 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:13:11,185 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:13:11,186 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:13:11,186 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 2 execution steps
2025-08-26 16:13:11,186 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: dea_split_by_condition for T cell
2025-08-26 16:13:11,186 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:13:11,186 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'bulk', 'cataract', 'age related macular degeneration']
2025-08-26 16:13:11,188 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:13:11,193 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:13:11,196 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:13:11,199 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj']
2025-08-26 16:13:11,200 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: display_dea_heatmap for T cell
2025-08-26 16:13:11,200 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 2 function: display_dea_heatmap
2025-08-26 16:13:11,200 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 2 successful steps
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 8478 characters for synthesis
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (273 chars)
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:13:11,201 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:13:19,400 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:13:19,403 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 2 execution steps
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (9654 chars)
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 9,654 chars)
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 9,654 bytes
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:13:19,404 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:13:19,405 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (806 chars)
2025-08-26 16:13:19,486 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:13:19,487 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:30:52,786 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/cell_types/utils.py changed, reloading.
2025-08-26 16:30:55,548 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:31:00,794 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:31:00,809 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:31:01,610 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:31:03,372 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:31:03,422 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:31:03,423 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:31:03,434 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:31:04,421 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:31:04,421 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:31:04,423 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:31:19,387 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:31:23,833 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:35:31,117 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:35:35,602 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:35:35,619 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:35:36,300 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:35:38,058 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:35:38,102 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:35:38,103 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:35:38,113 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:35:39,629 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:35:39,629 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:35:39,631 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:35:58,157 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:36:02,328 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:37:24,370 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:37:25,400 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 16:37:25,400 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 16:37:25,400 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 16:37:26,040 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 16:37:26,040 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 16:37:27,537 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 16:37:27,539 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 16:37:27,539 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 16:37:58,537 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:38:01,570 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:38:01,603 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 16:38:01,604 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 16:38:01,604 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:38:02,257 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:38:02,279 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 16:38:02,279 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 16:38:02,280 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 16:38:02,281 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to T cell.'
2025-08-26 16:38:04,582 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:38:11,005 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:38:12,010 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:38:12,013 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 16:38:12,014 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 16:38:12,014 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 16:38:12,049 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 16:38:12,081 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 16:38:12,081 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 16:38:12,081 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 16:38:12,082 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 16:38:12,083 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 16:38:12,084 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 16:38:12,085 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:38:12,085 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:38:12,088 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 16:38:12,088 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 16:38:20,381 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:38:29,117 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:06,597 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:06,602 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:39:06,603 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 16:39:06,605 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 16:39:06,630 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 16:39:06,630 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 16:39:06,630 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 16:39:06,630 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 16:39:06,630 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 16:39:06,632 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 16:39:06,632 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:39:06,632 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:39:06,633 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:39:06,633 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 16:39:06,633 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 16:39:06,633 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Mononuclear phagocyte', 'Stromal cell', 'Mast cell', 'T cell', 'Epithelial cell', 'B cell', 'Natural killer cell', 'Glial cell']}
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='T cell')
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 16:39:06,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_dea_heatmap(cell_type='T cell')
2025-08-26 16:39:06,635 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'T cell' not in missing list []
2025-08-26 16:39:06,635 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 16:39:06,635 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:39:06,635 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:39:06,636 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for T cells to identify differentially expressed genes between conditions.
2025-08-26 16:39:06,636 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:39:11,704 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 16:39:11,704 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:39:11,704 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 16:39:11,704 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 16:39:11,704 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Create a heatmap visualization of the top differentially expressed genes for T cells.
2025-08-26 16:39:11,705 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:39:11,705 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:39:12,335 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 16:39:12,336 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:39:12,336 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 16:39:12,336 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 16:39:12,336 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:39:12,336 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:39:12,337 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:39:12,337 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:39:13,585 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:15,247 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:15,257 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:39:15,257 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:39:15,904 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:15,906 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:39:16,700 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:39:16,701 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:39:16,702 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:39:16,702 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:39:16,702 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:39:16,702 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:39:16,702 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:39:17,726 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:18,295 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:18,296 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:39:18,296 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:39:19,058 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:19,059 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:39:19,773 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:19,776 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:39:19,776 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:39:19,776 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:39:19,777 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:39:19,778 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:39:19,779 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:39:19,780 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:39:19,780 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for T cell
2025-08-26 16:39:19,781 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:39:19,782 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['age related macular degeneration', 'bulk', 'cataract', 'basal laminar drusen']
2025-08-26 16:39:19,786 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:39:19,792 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:39:19,796 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:39:19,799 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:39:19,801 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for T cell
2025-08-26 16:39:19,801 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 16:39:19,801 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:39:19,801 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:39:19,801 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 8663 characters for synthesis
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:39:19,802 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:39:27,288 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:39:27,290 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (9709 chars)
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 9,709 chars)
2025-08-26 16:39:27,291 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 9,709 bytes
2025-08-26 16:39:27,292 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:39:27,292 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:39:27,292 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:39:27,293 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (794 chars)
2025-08-26 16:39:27,392 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:39:27,392 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:40:59,569 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/cell_types/utils.py changed, reloading.
2025-08-26 16:41:02,291 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:41:43,212 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:41:48,141 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:41:48,156 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:41:48,945 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:41:50,525 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:41:50,605 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:41:50,606 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:41:50,615 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:41:51,622 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:41:51,622 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:41:51,623 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:42:04,910 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:42:14,592 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:44:45,987 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:44:47,139 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 16:44:47,139 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 16:44:47,139 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 16:44:47,742 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 16:44:47,742 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 16:44:49,180 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 16:44:49,182 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 16:44:49,182 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 16:45:24,248 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:45:26,996 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 16:45:26,997 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 16:45:26,998 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:45:27,281 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:45:28,199 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:45:28,202 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state", "recent analysis results", "what other analyses available"]
```'
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 3 context sources: ['current_session_state', 'recent analysis results', 'what other analyses available']
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 16:45:28,203 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 16:45:28,248 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 16:45:28,248 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 16:45:28,248 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 16:45:28,249 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to T cell.'
2025-08-26 16:45:30,290 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:45:32,750 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:45:34,364 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:45:34,377 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 16:45:34,377 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Glial cell', 'Immune cell']
2025-08-26 16:45:34,378 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 16:45:34,510 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 16:45:34,528 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 16:45:34,529 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 16:45:34,530 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:45:34,530 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:45:34,531 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 16:45:34,531 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 16:45:38,280 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:45:41,714 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:20,288 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:20,340 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:46:20,340 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 16:46:20,341 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 16:46:20,371 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 16:46:20,371 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 16:46:20,372 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 16:46:20,372 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 16:46:20,372 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 16:46:20,374 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 16:46:20,374 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:46:20,374 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:46:20,374 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 16:46:20,375 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['T cell', 'Stromal cell', 'B cell', 'Epithelial cell', 'Natural killer cell', 'Glial cell', 'Mononuclear phagocyte', 'Mast cell']}
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='T cell')
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_dea_heatmap(cell_type='T cell')
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'T cell' not in missing list []
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:46:20,376 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:46:20,377 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for T cells to identify differentially expressed genes between conditions.
2025-08-26 16:46:20,377 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:46:30,112 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 16:46:30,113 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:46:30,113 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 16:46:30,113 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 16:46:30,113 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Create a heatmap visualization of the differentially expressed genes for T cells.
2025-08-26 16:46:30,113 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:46:30,114 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:46:30,305 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 16:46:30,306 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:46:30,306 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 16:46:30,306 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 16:46:30,306 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:46:30,307 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:46:30,307 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:46:30,307 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:46:32,060 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:32,727 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:32,728 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:46:32,728 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:46:33,361 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:33,363 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:46:34,994 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:46:35,009 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:46:35,010 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:46:36,420 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:37,027 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:37,028 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:46:37,028 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:46:37,750 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:37,751 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:46:38,666 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:38,669 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:46:38,670 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:46:38,670 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:46:38,670 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:46:38,670 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:46:38,671 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:46:38,672 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:46:38,672 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:46:38,673 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:46:38,673 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for T cell
2025-08-26 16:46:38,674 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:46:38,675 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'basal laminar drusen', 'age related macular degeneration']
2025-08-26 16:46:38,678 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:46:38,684 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:46:38,690 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:46:38,694 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:46:38,696 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for T cell
2025-08-26 16:46:38,696 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 16:46:38,696 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:46:38,696 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:46:38,696 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16914 characters for synthesis
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:46:38,697 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:46:45,919 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:46:45,929 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 16:46:45,930 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 16:46:45,930 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 16:46:45,931 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:46:45,931 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:46:45,932 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (9712 chars)
2025-08-26 16:46:45,932 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 9,712 chars)
2025-08-26 16:46:45,932 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 9,712 bytes
2025-08-26 16:46:45,933 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:46:45,934 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:46:45,934 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:46:45,935 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (965 chars)
2025-08-26 16:46:46,038 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:46:46,038 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:52:01,325 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 16:52:06,931 | INFO | faiss.loader | Loading faiss.
2025-08-26 16:52:06,959 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 16:52:07,723 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 16:52:09,434 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:52:09,514 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 16:52:09,515 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 16:52:09,524 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 16:52:10,544 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 16:52:10,544 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 16:52:10,546 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 16:52:29,772 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:52:55,740 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:06,142 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:07,188 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 16:56:07,189 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 16:56:07,189 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 16:56:08,045 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 16:56:08,045 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 16:56:10,028 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 16:56:10,030 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 16:56:10,030 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 16:56:13,894 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:56:16,668 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 16:56:16,670 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 16:56:16,670 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:56:16,921 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:56:19,934 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 16:56:20,288 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:20,300 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 16:56:20,309 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 16:56:20,309 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 16:56:20,309 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 16:56:20,309 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 16:56:20,309 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 16:56:20,310 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 16:56:20,310 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 16:56:20,310 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 16:56:20,310 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 16:56:20,311 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 16:56:20,311 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:56:20,312 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 16:56:20,312 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 16:56:20,312 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 16:56:20,312 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 16:56:20,312 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to T cell.'
2025-08-26 16:56:32,381 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:34,445 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:34,449 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 16:56:34,449 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 16:56:34,450 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 16:56:34,479 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 16:56:34,497 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:56:34,498 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:56:34,499 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 16:56:34,499 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 16:56:39,749 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:56:54,083 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:37,953 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:37,955 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 16:57:37,955 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 16:57:37,956 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 16:57:37,981 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 16:57:37,981 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 16:57:37,981 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 16:57:37,981 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 16:57:37,982 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 16:57:37,983 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 16:57:37,983 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 16:57:37,983 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 16:57:37,983 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:57:37,984 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 16:57:37,984 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 16:57:37,984 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Natural killer cell', 'Epithelial cell', 'B cell', 'T cell', 'Glial cell', 'Stromal cell', 'Mononuclear phagocyte', 'Mast cell']}
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='T cell')
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_dea_heatmap(cell_type='T cell')
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'T cell' not in missing list []
2025-08-26 16:57:37,985 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 16:57:37,986 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 16:57:37,986 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 16:57:37,986 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for T cells to identify differentially expressed genes between conditions.
2025-08-26 16:57:37,986 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 16:57:47,740 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 16:57:47,741 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 16:57:47,741 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 16:57:47,741 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 16:57:47,741 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Create a heatmap visualization of the top differentially expressed genes for T cells.
2025-08-26 16:57:47,741 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 16:57:47,741 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:57:48,271 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 16:57:48,272 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 16:57:48,272 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 16:57:48,272 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 16:57:48,272 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 16:57:48,273 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:57:48,273 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:57:48,273 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:57:51,059 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:51,664 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:51,664 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:57:51,664 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:57:52,270 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:52,271 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:57:53,047 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:57:53,058 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 16:57:53,059 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 16:57:54,487 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:55,124 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:55,131 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:57:55,131 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 16:57:55,885 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:55,888 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 16:57:57,048 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 16:57:57,068 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 16:57:57,069 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 16:57:57,069 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 16:57:57,070 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 16:57:57,070 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 16:57:57,070 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for T cell
2025-08-26 16:57:57,070 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 16:57:57,070 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['bulk', 'cataract', 'age related macular degeneration', 'basal laminar drusen']
2025-08-26 16:57:57,071 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:57:57,074 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:57:57,077 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:57:57,079 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for T cell
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 16:57:57,082 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-08-26 16:57:57,083 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 16:57:57,083 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 16:57:57,083 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 16:57:57,083 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 16:57:57,083 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 16:58:04,951 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 16:58:04,959 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 16:58:04,959 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 16:58:04,959 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 16:58:04,959 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 16:58:04,959 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (19622 chars)
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 19,622 chars)
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 19,622 bytes
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 16:58:04,960 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 16:58:04,961 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1234 chars)
2025-08-26 16:58:05,082 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 16:58:05,082 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 16:59:54,552 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/analysis/visualizations.py changed, reloading.
2025-08-26 16:59:56,749 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 17:00:01,510 | INFO | faiss.loader | Loading faiss.
2025-08-26 17:00:01,525 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 17:00:02,273 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 17:00:03,965 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 17:00:04,007 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 17:00:04,007 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 17:00:04,016 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 17:00:04,915 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 17:00:04,915 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 17:00:04,917 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 17:00:18,382 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:00:39,899 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:01:51,445 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 17:01:54,398 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 17:01:59,739 | INFO | faiss.loader | Loading faiss.
2025-08-26 17:01:59,777 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 17:02:00,667 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-08-26 17:02:02,348 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 17:02:02,408 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-08-26 17:02:02,409 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-08-26 17:02:02,421 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-08-26 17:02:03,423 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-08-26 17:02:03,423 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-08-26 17:02:03,425 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-08-26 17:02:20,102 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:02:24,616 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:06:23,919 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:06:24,942 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-08-26 17:06:24,942 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-08-26 17:06:24,942 | INFO | scchatbot.multi_agent_base | 1
2025-08-26 17:06:25,630 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-08-26 17:06:25,630 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-08-26 17:06:27,047 | INFO | scchatbot.multi_agent_base | 2
2025-08-26 17:06:27,050 | INFO | scchatbot.multi_agent_base | 3
2025-08-26 17:06:27,050 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-08-26 17:06:28,860 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 17:06:31,896 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 17:06:35,032 | WARNING | django.request | Not Found: /ws/chat/36fac317/
2025-08-26 17:06:39,959 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for '36fac317'
2025-08-26 17:06:39,961 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-08-26 17:06:39,961 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 17:06:40,559 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-08-26 17:06:40,561 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-08-26 17:06:40,562 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-08-26 17:06:40,563 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Do DEG to T cell.'
2025-08-26 17:06:47,344 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:06:48,276 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:06:48,287 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-08-26 17:06:48,287 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-08-26 17:06:48,288 | INFO | scchatbot.workflow.nodes.planning | 📋 Preserving LLM analysis step: dea_split_by_condition(T cell)
2025-08-26 17:06:48,326 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-08-26 17:06:48,349 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 1
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 4 steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 4 steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning |    • 2 analysis steps
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-08-26 17:06:48,350 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-08-26 17:06:48,351 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 17:06:48,351 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 17:06:48,352 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-08-26 17:06:48,352 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-08-26 17:06:53,367 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:06,551 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:40,809 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:40,813 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-08-26 17:07:40,813 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-08-26 17:07:40,814 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-08-26 17:07:40,844 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-08-26 17:07:40,845 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-08-26 17:07:40,845 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-08-26 17:07:40,845 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-08-26 17:07:40,845 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-08-26 17:07:40,847 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-08-26 17:07:40,847 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-08-26 17:07:40,847 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-08-26 17:07:40,847 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Mast cell', 'Glial cell', 'Epithelial cell', 'T cell', 'B cell', 'Mononuclear phagocyte', 'Stromal cell', 'Natural killer cell']}
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-08-26 17:07:40,848 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 2 remaining steps...
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: dea_split_by_condition(cell_type='T cell')
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4: display_dea_heatmap(cell_type='T cell')
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 4 cell type 'T cell' not in missing list []
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-08-26 17:07:40,849 | INFO | scchatbot.workflow.node_base |    Current message: Do DEG to T cell....
2025-08-26 17:07:40,850 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Perform differential expression analysis for T cells split by condition.
2025-08-26 17:07:40,850 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-08-26 17:07:50,697 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-08-26 17:07:50,699 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-08-26 17:07:50,699 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-08-26 17:07:50,699 | INFO | scchatbot.workflow.nodes.execution | 🎨 Continuing execution - visualization for same cell type: T cell
2025-08-26 17:07:50,699 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Create a heatmap visualization of the DEA results for T cells.
2025-08-26 17:07:50,699 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_dea_heatmap'
2025-08-26 17:07:50,699 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_dea_heatmap called with kwargs: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 17:07:50,923 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-08-26 17:07:50,924 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_dea_heatmap - HTML preserved
2025-08-26 17:07:50,924 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-08-26 17:07:50,924 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 2 steps
2025-08-26 17:07:50,924 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-08-26 17:07:50,925 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 17:07:50,925 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 17:07:50,925 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 17:07:52,210 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:53,256 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:53,274 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 17:07:53,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 17:07:53,872 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:53,874 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 17:07:54,575 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 17:07:54,581 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 17:07:54,582 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-08-26 17:07:54,582 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-08-26 17:07:54,582 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-08-26 17:07:55,691 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:56,387 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:56,392 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 17:07:56,392 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-08-26 17:07:57,093 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:07:59,572 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-08-26 17:08:01,014 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 3)
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_dea_heatmap (execution 4)
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['dea_split_by_condition', 'display_dea_heatmap']
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-08-26 17:08:01,016 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-08-26 17:08:01,017 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: dea_split_by_condition for T cell
2025-08-26 17:08:01,017 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-08-26 17:08:01,018 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['age related macular degeneration', 'basal laminar drusen', 'cataract', 'bulk']
2025-08-26 17:08:01,018 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 17:08:01,021 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 17:08:01,023 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 17:08:01,025 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-08-26 17:08:01,026 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_dea_heatmap for T cell
2025-08-26 17:08:01,026 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_dea_heatmap
2025-08-26 17:08:01,026 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'top_n_genes': 20, 'cluster_genes': True, 'cluster_samples': True}
2025-08-26 17:08:01,026 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_dea_heatmap with VisualizationResultAccessor
2025-08-26 17:08:01,026 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-08-26 17:08:01,027 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-08-26 17:08:08,976 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: dea_split_by_condition, success=True, has_result=True
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_dea_heatmap, success=True, has_result=True
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Dea Heatmap - T cell (21712 chars)
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 21,712 chars)
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 21,712 bytes
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-08-26 17:08:08,990 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-08-26 17:08:08,991 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (1259 chars)
2025-08-26 17:08:09,073 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-08-26 17:08:09,073 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for '36fac317' with 8 available cell types
2025-08-26 17:08:47,422 | WARNING | django.request | Not Found: /.well-known/appspecific/com.chrome.devtools.json
2025-08-26 17:10:47,369 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-08-26 17:10:51,617 | INFO | faiss.loader | Loading faiss.
2025-08-26 17:10:51,631 | INFO | faiss.loader | Successfully loaded faiss.
2025-08-26 17:10:52,341 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
