2025-09-16 21:38:03,158 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:38:03,160 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 21:38:03,161 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:38:03,162 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:38:03,167 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:38:03,167 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:38:03,168 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 21:38:03,168 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 21:38:13,190 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:38:13,191 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:38:15,116 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:15,801 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:15,813 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:38:15,814 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:38:16,395 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:16,407 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:38:17,003 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:17,010 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:38:17,010 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:38:17,012 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:38:17,013 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:38:17,014 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:38:17,014 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:38:17,014 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:38:17,015 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:38:17,015 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:38:17,016 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:38:19,038 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:19,622 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:19,633 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:38:19,634 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:38:20,187 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:20,198 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:38:20,739 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:20,742 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:38:20,742 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:38:20,743 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:38:20,744 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:38:20,745 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 21:38:20,747 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 21:38:20,748 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:38:20,749 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 21:38:20,749 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 21:38:20,749 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 21:38:20,749 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'age related macular degeneration', 'cataract', 'bulk']
2025-09-16 21:38:20,752 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:38:20,757 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:38:20,761 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:38:20,765 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:38:20,767 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16912 characters for synthesis
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 21:38:20,768 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 21:38:25,195 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (542 chars)
2025-09-16 21:38:25,198 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 542 chars)
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 542 bytes
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 21:38:25,199 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (479 chars)
2025-09-16 21:38:25,286 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 21:38:25,286 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 21:42:58,984 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 21:43:03,365 | INFO | faiss.loader | Loading faiss.
2025-09-16 21:43:03,387 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 21:43:04,185 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 21:43:06,010 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:43:06,099 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 21:43:06,100 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:43:06,110 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 21:43:07,065 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 21:43:07,065 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 21:43:07,066 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 21:43:21,108 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:43:24,142 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:45:56,768 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:45:57,778 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 21:45:57,779 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 21:45:57,779 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 21:45:58,236 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 21:45:58,236 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 21:45:59,733 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 21:45:59,736 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 21:45:59,736 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 21:46:25,433 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:46:28,535 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:46:31,399 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 21:46:31,401 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 21:46:31,401 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:46:31,549 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:46:33,311 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:46:33,314 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 21:46:33,314 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 21:46:33,314 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 21:46:33,315 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 21:46:33,317 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 21:46:33,319 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the violin plot for T cell with CD3D'
2025-09-16 21:46:36,620 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:46:38,246 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:46:38,272 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 21:46:38,273 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Glial cell', 'Immune cell']
2025-09-16 21:46:38,407 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 21:46:38,431 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 21:46:38,431 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 21:46:38,432 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 21:46:38,432 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 21:46:38,432 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 21:46:38,433 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 21:46:38,433 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 21:46:38,433 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 21:46:38,434 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 21:46:38,435 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 21:46:38,435 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 21:46:38,436 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:46:38,436 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:46:38,438 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 21:46:38,438 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 21:46:42,446 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:46:49,286 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:28,184 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:28,189 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 21:47:28,189 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 21:47:28,191 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 21:47:28,215 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 21:47:28,215 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 21:47:28,215 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 21:47:28,215 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 21:47:28,215 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 21:47:28,217 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 21:47:28,218 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 21:47:28,218 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:47:28,218 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:47:28,218 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['B cell', 'Glial cell', 'Stromal cell', 'Mast cell', 'Epithelial cell', 'T cell', 'Mononuclear phagocyte', 'Natural killer cell']}
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_violin_plot(cell_type='T cell')
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-09-16 21:47:28,219 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 21:47:28,220 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:47:28,220 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:47:28,221 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Create an interactive violin plot showing the distribution of CD3D gene expression across leiden clusters for T cells.
2025-09-16 21:47:28,221 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_violin_plot'
2025-09-16 21:47:28,221 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_violin_plot' with step parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:47:28,222 | INFO | scchatbot.multi_agent_base | 🔍 VIZ ADATA WRAPPER DEBUG: display_violin_plot called with kwargs: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:47:28,721 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 21:47:28,724 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 21:47:28,724 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmphker411f.
2025-09-16 21:47:28,724 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 21:47:28,724 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp1n7tcqfc.
2025-09-16 21:47:28,725 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp1n7tcqfc
2025-09-16 21:47:29,321 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmphker411f/index.html
2025-09-16 21:47:29,322 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 21:47:29,903 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 21:47:29,904 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 21:47:29,904 | INFO | kaleido.kaleido | Got 07E7
2025-09-16 21:47:29,904 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.png
2025-09-16 21:47:29,904 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 21:47:29,972 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 21:47:29,973 | INFO | kaleido.kaleido | Reloading tab 07E7 before return.
2025-09-16 21:47:30,056 | INFO | kaleido.kaleido | Putting tab 07E7 back (queue size: 0).
2025-09-16 21:47:30,057 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 21:47:30,057 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 21:47:30,057 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:30,057 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:30,057 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:47:30,057 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:47:30,057 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:47:30,058 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:30,058 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:30,058 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:47:30,058 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:47:30,059 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:47:30,144 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:30,144 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:30,146 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 21:47:30,147 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 21:47:30,147 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3nt6efk6.
2025-09-16 21:47:30,147 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 21:47:30,147 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpfx88n95j.
2025-09-16 21:47:30,148 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpfx88n95j
2025-09-16 21:47:30,610 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3nt6efk6/index.html
2025-09-16 21:47:30,612 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 21:47:31,167 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 21:47:31,167 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 21:47:31,167 | INFO | kaleido.kaleido | Got 5B7D
2025-09-16 21:47:31,167 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf
2025-09-16 21:47:31,167 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 21:47:31,210 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 21:47:31,266 | INFO | kaleido.kaleido | Reloading tab 5B7D before return.
2025-09-16 21:47:31,352 | INFO | kaleido.kaleido | Putting tab 5B7D back (queue size: 0).
2025-09-16 21:47:31,352 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 21:47:31,352 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 21:47:31,352 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:31,353 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:31,353 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:47:31,353 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:47:31,353 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:47:31,354 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:31,354 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:31,354 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:47:31,354 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:47:31,354 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:47:31,440 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:31,440 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:31,460 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:47:31,465 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:47:31,467 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 21:47:31,470 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_violin_plot - HTML preserved
2025-09-16 21:47:31,470 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 21:47:31,470 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:47:31,471 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:47:31,471 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 21:47:31,475 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:47:31,475 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:47:33,483 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:34,074 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:34,167 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:34,168 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:47:34,688 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:34,690 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:36,110 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:36,119 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:47:36,120 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:47:36,120 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:47:36,121 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 21:47:36,122 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:47:36,122 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:47:36,123 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:47:36,123 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:47:36,124 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 21:47:36,124 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 21:47:46,272 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 21:47:46,273 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 21:47:46,273 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 21:47:46,273 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:47:46,273 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:47:46,274 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:47:46,274 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:47:46,274 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:47:47,628 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:48,235 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:48,247 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:48,248 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:47:49,268 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:49,284 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:49,935 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:49,944 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:47:49,944 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:47:49,944 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:47:49,944 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:47:49,944 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:47:49,945 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:47:49,946 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:47:49,946 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:47:49,946 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:47:51,387 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:52,177 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:52,187 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:52,188 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:47:52,794 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:52,804 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:47:53,274 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:53,277 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:47:53,277 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:47:53,277 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:47:53,277 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:47:53,278 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:47:53,279 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:47:53,279 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 21:47:53,280 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 21:47:53,280 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 21:47:53,281 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 21:47:53,282 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['cataract', 'age related macular degeneration', 'bulk', 'basal laminar drusen']
2025-09-16 21:47:53,286 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:47:53,292 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:47:53,295 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:47:53,298 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:47:53,300 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 21:47:53,301 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 21:47:58,112 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (18127 chars)
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 21:47:58,125 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 18,127 chars)
2025-09-16 21:47:58,126 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 18,127 bytes
2025-09-16 21:47:58,126 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 21:47:58,126 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 21:47:58,126 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 21:47:58,126 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (375 chars)
2025-09-16 21:47:58,207 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 21:47:58,207 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 21:50:30,992 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/analysis/visualizations.py changed, reloading.
2025-09-16 21:50:32,066 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:50:32,066 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:50:34,023 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 21:50:39,194 | INFO | faiss.loader | Loading faiss.
2025-09-16 21:50:39,208 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 21:50:40,115 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 21:50:41,911 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:50:41,961 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 21:50:41,962 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:50:41,974 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 21:50:42,879 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 21:50:42,879 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 21:50:42,881 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 21:50:56,152 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:51:00,570 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:51:44,122 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:51:45,124 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 21:51:45,124 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 21:51:45,125 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 21:51:45,582 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 21:51:45,582 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 21:51:46,905 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 21:51:46,908 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 21:51:46,908 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 21:52:36,488 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:52:39,541 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:52:41,996 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 21:52:42,000 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 21:52:42,000 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:52:42,552 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 21:52:42,959 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:52:42,963 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 21:52:42,964 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 21:52:42,965 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 21:52:42,965 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 21:52:42,965 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 21:52:42,967 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 21:52:42,968 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the violin plot for T cell with CD3D'
2025-09-16 21:52:46,047 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:52:48,116 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:52:48,127 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 21:52:48,128 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-09-16 21:52:48,165 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 21:52:48,185 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 21:52:48,188 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 21:52:48,189 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 21:52:48,189 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 21:52:48,189 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 21:52:48,189 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 21:52:48,189 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 21:52:48,190 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 21:52:48,191 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:52:48,191 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:52:48,192 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 21:52:48,192 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 21:52:52,505 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:52:55,077 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:31,779 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:31,794 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 21:53:31,795 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 21:53:31,795 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 21:53:31,820 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 21:53:31,820 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 21:53:31,820 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 21:53:31,820 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 21:53:31,820 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 21:53:31,822 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 21:53:31,822 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 21:53:31,822 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:53:31,822 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 21:53:31,823 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Natural killer cell', 'Glial cell', 'B cell', 'Epithelial cell', 'Mast cell', 'Mononuclear phagocyte', 'Stromal cell', 'T cell']}
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_violin_plot(cell_type='T cell')
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:53:31,824 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:53:31,825 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Create an interactive violin plot to show the distribution of CD3D gene expression across leiden clusters for T cells, with pre/post treatment comparison if available.
2025-09-16 21:53:31,825 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_violin_plot'
2025-09-16 21:53:31,825 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_violin_plot' with step parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:53:31,825 | INFO | scchatbot.multi_agent_base | 🔍 VIZ ADATA WRAPPER DEBUG: display_violin_plot called with kwargs: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:53:32,318 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 21:53:32,319 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 21:53:32,319 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpj1czgxgf.
2025-09-16 21:53:32,319 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 21:53:32,320 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp1zsmk1gs.
2025-09-16 21:53:32,320 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp1zsmk1gs
2025-09-16 21:53:32,877 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpj1czgxgf/index.html
2025-09-16 21:53:32,882 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 21:53:33,424 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 21:53:33,425 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 21:53:33,425 | INFO | kaleido.kaleido | Got 7410
2025-09-16 21:53:33,425 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.png
2025-09-16 21:53:33,425 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 21:53:33,497 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 21:53:33,498 | INFO | kaleido.kaleido | Reloading tab 7410 before return.
2025-09-16 21:53:33,583 | INFO | kaleido.kaleido | Putting tab 7410 back (queue size: 0).
2025-09-16 21:53:33,583 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 21:53:33,583 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 21:53:33,583 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:33,583 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:33,584 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:53:33,584 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:53:33,584 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:53:33,584 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:33,584 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:33,585 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:53:33,585 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:53:33,585 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:53:33,676 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:33,677 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:33,679 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 21:53:33,679 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 21:53:33,687 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp48kmhmco.
2025-09-16 21:53:33,688 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 21:53:33,689 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpz268z29t.
2025-09-16 21:53:33,689 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpz268z29t
2025-09-16 21:53:34,165 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp48kmhmco/index.html
2025-09-16 21:53:34,184 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 21:53:34,738 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 21:53:34,739 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 21:53:34,739 | INFO | kaleido.kaleido | Got 7992
2025-09-16 21:53:34,739 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf
2025-09-16 21:53:34,739 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 21:53:34,781 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 21:53:34,834 | INFO | kaleido.kaleido | Reloading tab 7992 before return.
2025-09-16 21:53:34,917 | INFO | kaleido.kaleido | Putting tab 7992 back (queue size: 0).
2025-09-16 21:53:34,917 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 21:53:34,917 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 21:53:34,918 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:34,918 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:34,918 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:53:34,918 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:53:34,918 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:53:34,919 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:34,920 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:34,920 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 21:53:34,920 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 21:53:34,920 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 21:53:35,080 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:35,080 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:35,092 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 21:53:35,093 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_violin_plot - HTML preserved
2025-09-16 21:53:35,094 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 21:53:35,094 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:53:35,094 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:53:35,094 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 21:53:35,094 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:53:35,095 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:53:35,983 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:53:35,983 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:53:37,261 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:37,775 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:37,780 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:37,781 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:53:38,472 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:38,474 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:39,139 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:39,149 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:53:39,149 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 21:53:39,150 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 21:53:39,151 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:53:39,151 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 21:53:39,151 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 21:53:39,151 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:53:39,151 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 21:53:39,152 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 21:53:39,152 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:53:39,152 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 21:53:39,152 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:53:39,152 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:53:39,153 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 21:53:39,153 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 21:53:39,158 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 21:53:39,159 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 21:53:49,401 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:53:49,402 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:53:51,292 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:51,914 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:51,916 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:51,916 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:53:52,724 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:52,732 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:53,373 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:53,373 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:53:53,374 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 21:53:53,375 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 21:53:53,375 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 21:53:56,156 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:56,679 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:56,693 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:56,694 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 21:53:57,507 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:57,512 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 21:53:57,982 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:53:57,991 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 21:53:57,992 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 21:53:57,992 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 21:53:57,992 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 21:53:57,993 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 21:53:57,993 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 21:53:57,993 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 21:53:57,994 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 21:53:57,994 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 21:53:57,994 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 21:53:57,994 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 21:53:57,994 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 21:53:57,996 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 21:53:57,996 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 21:53:57,996 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 21:53:57,996 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 21:53:57,996 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 21:53:57,996 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 21:53:57,997 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 21:53:57,997 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 21:53:57,997 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 21:53:57,998 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 21:53:57,999 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 21:53:57,999 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 21:53:57,999 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 21:53:58,000 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'bulk', 'age related macular degeneration', 'cataract']
2025-09-16 21:53:58,002 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:53:58,005 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:53:58,007 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:53:58,009 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 21:53:58,010 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 21:53:58,011 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 21:54:02,935 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (18127 chars)
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 18,127 chars)
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 18,127 bytes
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 21:54:02,938 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 21:54:02,939 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (508 chars)
2025-09-16 21:54:02,996 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 21:54:02,996 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 21:57:00,659 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/analysis/visualizations.py changed, reloading.
2025-09-16 21:57:01,307 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 21:57:01,308 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 21:57:03,087 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 21:57:57,960 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 21:58:02,854 | INFO | faiss.loader | Loading faiss.
2025-09-16 21:58:02,880 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 21:58:03,836 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 21:58:05,606 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:58:05,680 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 21:58:05,680 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 21:58:05,689 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 21:58:06,825 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 21:58:06,825 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 21:58:06,828 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 21:58:23,089 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 21:58:29,477 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:01:52,275 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 22:01:57,141 | INFO | faiss.loader | Loading faiss.
2025-09-16 22:01:57,155 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 22:01:58,054 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 22:01:59,711 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:01:59,799 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 22:01:59,799 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:01:59,808 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 22:02:00,889 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 22:02:00,889 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 22:02:00,891 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 22:02:30,927 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:03:01,978 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:07:52,476 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:07:53,479 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 22:07:53,480 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 22:07:53,480 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 22:07:54,083 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 22:07:54,083 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 22:07:55,674 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 22:07:55,676 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 22:07:55,676 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 22:08:26,957 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:08:30,547 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:08:33,240 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 22:08:33,241 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 22:08:33,241 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:08:33,567 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:08:34,460 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:08:34,465 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 22:08:34,466 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 22:08:34,466 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 22:08:34,467 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 22:08:34,468 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 22:08:34,468 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 22:08:34,468 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 22:08:34,468 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 22:08:34,468 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 22:08:34,469 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 22:08:34,470 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 22:08:34,471 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the violin plot for T cell with CD3D'
2025-09-16 22:08:41,655 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:08:43,553 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:08:43,557 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 22:08:43,558 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-09-16 22:08:43,589 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 22:08:43,607 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 22:08:43,607 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 22:08:43,607 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 22:08:43,608 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 22:08:43,609 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 22:08:43,610 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 22:08:43,610 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:08:43,610 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:08:43,612 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 22:08:43,612 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 22:08:48,938 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:02,650 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:38,467 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:38,473 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 22:09:38,481 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 22:09:38,482 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 22:09:38,506 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 22:09:38,506 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 22:09:38,506 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 22:09:38,506 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 22:09:38,507 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 22:09:38,508 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 22:09:38,508 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 22:09:38,508 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:09:38,508 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 22:09:38,509 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Mast cell', 'Mononuclear phagocyte', 'B cell', 'Natural killer cell', 'T cell', 'Epithelial cell', 'Glial cell', 'Stromal cell']}
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_violin_plot(cell_type='T cell')
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:09:38,510 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:09:38,511 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Create an interactive violin plot to show the distribution of CD3D gene expression across leiden clusters for T cells.
2025-09-16 22:09:38,511 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_violin_plot'
2025-09-16 22:09:38,512 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_violin_plot' with step parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:09:38,512 | INFO | scchatbot.multi_agent_base | 🔍 VIZ ADATA WRAPPER DEBUG: display_violin_plot called with kwargs: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:09:38,928 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:09:38,928 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:09:38,929 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpz5ru4twt.
2025-09-16 22:09:38,929 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:09:38,929 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3iokxyrx.
2025-09-16 22:09:38,930 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3iokxyrx
2025-09-16 22:09:39,525 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpz5ru4twt/index.html
2025-09-16 22:09:39,527 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:09:40,048 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:09:40,049 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:09:40,049 | INFO | kaleido.kaleido | Got 6B54
2025-09-16 22:09:40,049 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.png
2025-09-16 22:09:40,049 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:09:40,109 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:09:40,111 | INFO | kaleido.kaleido | Reloading tab 6B54 before return.
2025-09-16 22:09:40,184 | INFO | kaleido.kaleido | Putting tab 6B54 back (queue size: 0).
2025-09-16 22:09:40,184 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:09:40,184 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:09:40,184 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:40,184 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:40,185 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:09:40,185 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:09:40,185 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:09:40,185 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:40,186 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:40,186 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:09:40,186 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:09:40,186 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:09:40,269 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:40,269 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:40,271 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:09:40,272 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:09:40,272 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp4hnyp6le.
2025-09-16 22:09:40,273 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:09:40,273 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3bhljaao.
2025-09-16 22:09:40,273 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp3bhljaao
2025-09-16 22:09:40,705 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp4hnyp6le/index.html
2025-09-16 22:09:40,706 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:09:41,249 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:09:41,249 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:09:41,250 | INFO | kaleido.kaleido | Got 4225
2025-09-16 22:09:41,250 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf
2025-09-16 22:09:41,250 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:09:41,289 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:09:41,338 | INFO | kaleido.kaleido | Reloading tab 4225 before return.
2025-09-16 22:09:41,411 | INFO | kaleido.kaleido | Putting tab 4225 back (queue size: 0).
2025-09-16 22:09:41,412 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:09:41,412 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:09:41,412 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:41,412 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:41,412 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:09:41,412 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:09:41,412 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:09:41,413 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:41,413 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:41,413 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:09:41,413 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:09:41,413 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:09:41,503 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:41,503 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:41,515 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_violin_plot - HTML preserved
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:09:41,516 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:09:42,259 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:09:42,259 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:09:43,457 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:44,099 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:44,124 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:09:44,124 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:09:44,882 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:44,893 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:09:45,426 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:45,428 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:09:45,429 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:09:45,430 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 22:09:45,431 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:09:45,431 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:09:45,432 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:09:45,432 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:09:45,434 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 22:09:45,435 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 22:09:55,021 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 22:09:55,022 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 22:09:55,022 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 22:09:55,022 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:09:55,022 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:09:55,023 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:09:55,023 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:09:55,023 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:09:57,235 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:57,964 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:57,979 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:09:57,980 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:09:58,521 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:58,521 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:09:59,165 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:09:59,168 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:09:59,168 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:09:59,169 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:09:59,169 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:09:59,170 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:09:59,170 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:09:59,171 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:09:59,171 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:09:59,172 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:09:59,173 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:09:59,174 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:09:59,174 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:09:59,174 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:10:01,549 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:10:02,233 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:10:02,239 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:10:02,240 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:10:03,155 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:10:03,158 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:10:03,679 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:10:03,688 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:10:03,689 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:10:03,690 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:10:03,691 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:10:03,692 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:10:03,693 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 22:10:03,694 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 22:10:03,695 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:10:03,696 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 22:10:03,696 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 22:10:03,696 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 22:10:03,696 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'age related macular degeneration', 'cataract', 'bulk']
2025-09-16 22:10:03,698 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:10:03,702 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:10:03,707 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:10:03,715 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:10:03,718 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 22:10:03,718 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-09-16 22:10:03,719 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 22:10:03,719 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 22:10:03,719 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 22:10:03,719 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 22:10:03,719 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 22:10:03,720 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 22:10:08,380 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:10:08,382 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 22:10:08,383 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 22:10:08,383 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 22:10:08,383 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 22:10:08,383 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (18370 chars)
2025-09-16 22:10:08,383 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 22:10:08,384 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 18,370 chars)
2025-09-16 22:10:08,384 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 18,370 bytes
2025-09-16 22:10:08,384 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 22:10:08,384 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 22:10:08,384 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 22:10:08,385 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (554 chars)
2025-09-16 22:10:08,497 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 22:10:08,497 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 22:15:34,421 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/analysis/visualizations.py changed, reloading.
2025-09-16 22:15:34,984 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:15:34,986 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:15:36,814 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 22:17:18,144 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 22:17:22,874 | INFO | faiss.loader | Loading faiss.
2025-09-16 22:17:22,899 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 22:17:23,737 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 22:17:25,602 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:17:25,688 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 22:17:25,688 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:17:25,697 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 22:17:26,657 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 22:17:26,657 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 22:17:26,660 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 22:17:50,383 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:18:07,954 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:20:39,727 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:20:40,820 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 22:20:40,821 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 22:20:40,821 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 22:20:41,220 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 22:20:41,220 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 22:20:42,998 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 22:20:43,001 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 22:20:43,001 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 22:20:58,449 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:21:01,524 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:21:04,508 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 22:21:04,510 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 22:21:04,511 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:21:04,531 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:21:06,296 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:06,307 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 22:21:06,307 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 22:21:06,308 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 22:21:06,308 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 22:21:06,308 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 22:21:06,309 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 22:21:06,309 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 22:21:06,310 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 22:21:06,311 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 22:21:06,311 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 22:21:06,312 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 22:21:06,313 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:21:06,314 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 22:21:06,314 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 22:21:06,314 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 22:21:06,314 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 22:21:06,314 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the violin plot for T cell with CD3D'
2025-09-16 22:21:09,644 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:11,513 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:11,513 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 22:21:11,514 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-09-16 22:21:11,544 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 22:21:11,559 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:21:11,560 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:21:11,561 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 22:21:11,561 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 22:21:15,243 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:25,076 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:59,362 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:21:59,366 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 22:21:59,366 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 22:21:59,368 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 22:21:59,398 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 22:21:59,398 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 22:21:59,398 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 22:21:59,398 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 22:21:59,398 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 22:21:59,399 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 22:21:59,400 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['T cell', 'B cell', 'Glial cell', 'Mononuclear phagocyte', 'Stromal cell', 'Mast cell', 'Natural killer cell', 'Epithelial cell']}
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_violin_plot(cell_type='T cell')
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:21:59,401 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:21:59,402 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Create an interactive violin plot to show the distribution of CD3D gene expression across T cell clusters.
2025-09-16 22:21:59,402 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_violin_plot'
2025-09-16 22:21:59,402 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_violin_plot' with step parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:21:59,402 | INFO | scchatbot.multi_agent_base | 🔍 VIZ ADATA WRAPPER DEBUG: display_violin_plot called with kwargs: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:21:59,836 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:21:59,836 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:21:59,836 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp68luww0s.
2025-09-16 22:21:59,837 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:21:59,837 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmplozlvsif.
2025-09-16 22:21:59,837 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmplozlvsif
2025-09-16 22:22:00,354 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp68luww0s/index.html
2025-09-16 22:22:00,354 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:22:00,912 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:22:00,913 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:22:00,913 | INFO | kaleido.kaleido | Got 9D19
2025-09-16 22:22:00,913 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.png
2025-09-16 22:22:00,913 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:22:00,980 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:22:00,982 | INFO | kaleido.kaleido | Reloading tab 9D19 before return.
2025-09-16 22:22:01,058 | INFO | kaleido.kaleido | Putting tab 9D19 back (queue size: 0).
2025-09-16 22:22:01,058 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:22:01,058 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:22:01,059 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:01,059 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:01,059 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:22:01,059 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:22:01,059 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:22:01,060 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:01,060 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:01,060 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:22:01,060 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:22:01,060 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:22:01,143 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:01,143 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:01,146 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:22:01,146 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:22:01,146 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpqf1y3xdd.
2025-09-16 22:22:01,146 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:22:01,147 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp50kmbwum.
2025-09-16 22:22:01,147 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp50kmbwum
2025-09-16 22:22:01,552 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpqf1y3xdd/index.html
2025-09-16 22:22:01,552 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:22:02,222 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:22:02,224 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:22:02,224 | INFO | kaleido.kaleido | Got 15B3
2025-09-16 22:22:02,224 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf
2025-09-16 22:22:02,224 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:22:02,271 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:22:02,326 | INFO | kaleido.kaleido | Reloading tab 15B3 before return.
2025-09-16 22:22:02,403 | INFO | kaleido.kaleido | Putting tab 15B3 back (queue size: 0).
2025-09-16 22:22:02,403 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:22:02,403 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:22:02,403 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:02,403 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:02,403 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:22:02,403 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:22:02,403 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:22:02,404 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:02,404 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:02,404 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:22:02,404 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:22:02,404 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:22:02,493 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:02,493 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:02,507 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 22:22:02,508 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_violin_plot - HTML preserved
2025-09-16 22:22:02,508 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 22:22:02,508 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:22:02,508 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:22:02,509 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 22:22:02,510 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:22:02,510 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:22:03,314 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:22:03,314 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:22:04,254 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:05,318 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:05,321 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:05,321 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:22:05,984 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:05,987 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:06,594 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:06,597 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 22:22:06,598 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:22:06,599 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:22:06,601 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:22:06,601 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:22:06,603 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 22:22:06,604 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 22:22:16,168 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 22:22:16,169 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 22:22:16,169 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 22:22:16,169 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:22:16,169 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:22:16,170 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:22:16,170 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:22:16,170 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:22:18,078 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:18,797 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:18,803 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:18,803 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:22:19,590 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:19,595 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:20,290 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:20,294 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:22:20,294 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:22:20,295 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:22:20,296 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:22:20,296 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:22:20,296 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:22:20,297 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:22:20,297 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:22:20,297 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:22:22,200 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:22,819 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:22,823 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:22,823 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:22:23,478 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:23,481 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:22:24,729 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:24,731 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:22:24,731 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:22:24,731 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:22:24,731 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:22:24,732 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:22:24,733 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:22:24,733 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:22:24,733 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 22:22:24,734 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 22:22:24,735 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 22:22:24,735 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 22:22:24,735 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:22:24,735 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 22:22:24,735 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 22:22:24,736 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 22:22:24,736 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['basal laminar drusen', 'cataract', 'bulk', 'age related macular degeneration']
2025-09-16 22:22:24,738 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:22:24,743 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:22:24,745 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:22:24,746 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:22:24,747 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 22:22:24,748 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 22:22:28,111 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:22:28,111 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (18430 chars)
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 18,430 chars)
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 18,430 bytes
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 22:22:28,112 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 22:22:28,113 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (450 chars)
2025-09-16 22:22:28,195 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 22:22:28,195 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 22:33:29,628 | INFO | django.utils.autoreload | /Users/seanchiu/Desktop/scchat_fin/scChat/scchatbot/analysis/visualizations.py changed, reloading.
2025-09-16 22:33:30,358 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:33:30,359 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:33:32,231 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 22:34:42,156 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 22:34:47,064 | INFO | faiss.loader | Loading faiss.
2025-09-16 22:34:47,091 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 22:34:47,961 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 22:34:50,355 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:34:50,432 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 22:34:50,433 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 22:34:50,440 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 22:34:51,328 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 22:34:51,328 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 22:34:51,331 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 22:35:08,431 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:35:34,244 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:38:41,158 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:38:42,146 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 22:38:42,146 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 22:38:42,146 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 22:38:42,580 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 22:38:42,581 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 22:38:44,432 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 22:38:44,434 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 22:38:44,434 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 22:40:32,308 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:40:35,521 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:40:38,127 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 22:40:38,128 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 22:40:38,128 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:40:38,529 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 22:40:39,431 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:40:39,440 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 22:40:39,441 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 22:40:39,441 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 22:40:39,441 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 22:40:39,442 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 22:40:39,442 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 22:40:39,442 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 22:40:39,442 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 22:40:39,442 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 22:40:39,443 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 22:40:39,446 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the violin plot for T cell with CD3D'
2025-09-16 22:40:49,590 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:40:52,380 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:40:52,393 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 22:40:52,399 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Immune cell', 'Glial cell']
2025-09-16 22:40:52,440 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 22:40:52,459 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 22:40:52,460 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 22:40:52,461 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 22:40:52,461 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 22:40:52,461 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:40:52,462 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:40:52,463 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 22:40:52,463 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 22:40:56,135 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:41:13,588 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:41:54,776 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:41:54,779 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 22:41:54,780 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 22:41:54,780 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 22:41:54,808 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 22:41:54,808 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 22:41:54,808 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 22:41:54,808 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 22:41:54,808 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 22:41:54,810 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 22:41:54,810 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 22:41:54,810 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:41:54,811 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:41:54,811 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 22:41:54,811 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 22:41:54,811 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['B cell', 'Mast cell', 'Mononuclear phagocyte', 'Natural killer cell', 'T cell', 'Glial cell', 'Stromal cell', 'Epithelial cell']}
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_violin_plot(cell_type='T cell')
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'T cell' not in missing list []
2025-09-16 22:41:54,812 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 22:41:54,813 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:41:54,813 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:41:54,814 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Create an interactive violin plot to show the distribution of CD3D gene expression across leiden clusters for T cells.
2025-09-16 22:41:54,814 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_violin_plot'
2025-09-16 22:41:54,814 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_violin_plot' with step parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:41:54,814 | INFO | scchatbot.multi_agent_base | 🔍 VIZ ADATA WRAPPER DEBUG: display_violin_plot called with kwargs: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:41:55,348 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:41:55,350 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:41:55,350 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp7n6gqyhq.
2025-09-16 22:41:55,351 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:41:55,351 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmptql91wd7.
2025-09-16 22:41:55,351 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmptql91wd7
2025-09-16 22:41:55,893 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp7n6gqyhq/index.html
2025-09-16 22:41:55,895 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:41:56,429 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:41:56,430 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:41:56,430 | INFO | kaleido.kaleido | Got 3828
2025-09-16 22:41:56,430 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.png
2025-09-16 22:41:56,430 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:41:56,500 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.png.
2025-09-16 22:41:56,502 | INFO | kaleido.kaleido | Reloading tab 3828 before return.
2025-09-16 22:41:56,584 | INFO | kaleido.kaleido | Putting tab 3828 back (queue size: 0).
2025-09-16 22:41:56,584 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:41:56,584 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:41:56,584 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:56,585 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:56,585 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:41:56,585 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:41:56,585 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:41:56,586 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:56,586 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:56,586 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:41:56,586 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:41:56,587 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:41:56,682 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:56,683 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:56,686 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 22:41:56,688 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 22:41:56,689 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmplec8xx90.
2025-09-16 22:41:56,689 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 22:41:56,690 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpid39rdtr.
2025-09-16 22:41:56,690 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpid39rdtr
2025-09-16 22:41:57,096 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmplec8xx90/index.html
2025-09-16 22:41:57,096 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 22:41:57,899 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 22:41:57,899 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 22:41:57,899 | INFO | kaleido.kaleido | Got CD8D
2025-09-16 22:41:57,899 | INFO | kaleido._kaleido_tab | Processing CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf
2025-09-16 22:41:57,900 | INFO | kaleido._kaleido_tab | Sending big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:41:57,944 | INFO | kaleido._kaleido_tab | Sent big command for CD3D_Expression_in_T_cell_by_Leiden_Cluster.pdf.
2025-09-16 22:41:57,996 | INFO | kaleido.kaleido | Reloading tab CD8D before return.
2025-09-16 22:41:58,072 | INFO | kaleido.kaleido | Putting tab CD8D back (queue size: 0).
2025-09-16 22:41:58,072 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 22:41:58,072 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 22:41:58,073 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:58,073 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:58,073 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:41:58,073 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:41:58,073 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:41:58,074 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:58,074 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:58,074 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 22:41:58,074 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 22:41:58,074 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 22:41:58,166 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 22:41:58,166 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 22:41:58,181 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 22:41:58,182 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_violin_plot - HTML preserved
2025-09-16 22:41:58,182 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 22:41:58,182 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:41:58,182 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:41:58,183 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 22:41:58,183 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:41:58,183 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:42:00,509 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:01,492 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:01,499 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:01,499 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:42:02,478 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:02,489 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:03,212 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:42:03,214 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot']
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: dea_split_by_condition(T cell)
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:42:03,215 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 22:42:03,216 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 22:42:03,216 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:42:03,216 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 22:42:03,216 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:42:03,216 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:42:03,217 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 22:42:03,217 | INFO | scchatbot.workflow.node_base |    Current message: Plot the violin plot for T cell with CD3D...
2025-09-16 22:42:03,218 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: dea_split_by_condition for T cell
2025-09-16 22:42:03,218 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'dea_split_by_condition'
2025-09-16 22:42:13,250 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: dea_split_by_condition - Full data preserved
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:42:13,253 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:42:15,380 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:15,984 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:16,001 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:16,001 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:42:16,591 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:16,593 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:17,289 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:17,300 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:42:17,300 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:42:17,300 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:42:17,300 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:42:17,300 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:42:17,301 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:42:17,302 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:42:17,302 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:42:17,302 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:42:17,302 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:42:17,302 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:42:17,303 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 22:42:17,303 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 22:42:17,303 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 22:42:19,145 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:19,932 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:19,935 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:19,936 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 22:42:20,902 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:20,907 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 22:42:22,173 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:22,182 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["dea_split_by_condition"]
```' (length: 38)
2025-09-16 22:42:22,182 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['dea_split_by_condition']
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_violin_plot (execution 3)
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: dea_split_by_condition (execution 4)
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_violin_plot', 'dea_split_by_condition']
2025-09-16 22:42:22,183 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 22:42:22,184 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 22:42:22,184 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 22:42:22,184 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 22:42:22,184 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 22:42:22,185 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 22:42:22,185 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 22:42:22,185 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 22:42:22,185 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 22:42:22,186 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 22:42:22,186 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 22:42:22,187 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 22:42:22,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 22:42:22,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_violin_plot for T cell
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_violin_plot
2025-09-16 22:42:22,189 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell', 'genes': ['CD3D']}
2025-09-16 22:42:22,190 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_violin_plot with VisualizationResultAccessor
2025-09-16 22:42:22,190 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: dea_split_by_condition for T cell
2025-09-16 22:42:22,190 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling dea_split_by_condition with DEAResultAccessor
2025-09-16 22:42:22,190 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 DEA: Loaded 4 conditions from mapping file: ['age related macular degeneration', 'cataract', 'basal laminar drusen', 'bulk']
2025-09-16 22:42:22,192 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for age related macular degeneration: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:42:22,197 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for cataract: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:42:22,202 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for basal laminar drusen: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:42:22,206 | INFO | scchatbot.workflow.unified_result_accessor | 📊 DEA CSV columns for bulk: ['names', 'scores', 'logfoldchanges', 'pvals', 'pvals_adj', 'direction']
2025-09-16 22:42:22,208 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 16915 characters for synthesis
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 22:42:22,209 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 22:42:26,855 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 22:42:26,856 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 22:42:26,856 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 22:42:26,856 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 22:42:26,857 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_violin_plot, success=True, has_result=True
2025-09-16 22:42:26,857 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Violin Plot - T cell (17025 chars)
2025-09-16 22:42:26,857 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: dea_split_by_condition, success=True, has_result=True
2025-09-16 22:42:26,857 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 17,025 chars)
2025-09-16 22:42:26,857 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 17,025 bytes
2025-09-16 22:42:26,858 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 22:42:26,858 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 22:42:26,858 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 22:42:26,858 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (589 chars)
2025-09-16 22:42:26,941 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 22:42:26,941 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
2025-09-16 23:39:40,262 | INFO | django.utils.autoreload | Watching for file changes with StatReloader
2025-09-16 23:39:45,322 | INFO | faiss.loader | Loading faiss.
2025-09-16 23:39:45,349 | INFO | faiss.loader | Successfully loaded faiss.
2025-09-16 23:39:46,205 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-09-16 23:39:47,991 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 23:39:48,077 | INFO | scchatbot.workflow.function_history | ✅ Vector database initialized at conversation_history/conversation_vectors
2025-09-16 23:39:48,077 | INFO | chromadb.telemetry.product.posthog | Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-09-16 23:39:48,085 | INFO | scchatbot.workflow.function_history | ✅ Enrichment vector database initialized at conversation_history/conversation_vectors/enrichment
2025-09-16 23:39:49,032 | INFO | jax._src.xla_bridge | Unable to initialize backend 'cuda': 
2025-09-16 23:39:49,032 | INFO | jax._src.xla_bridge | Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
2025-09-16 23:39:49,034 | INFO | jax._src.xla_bridge | Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/opt/anaconda3/envs/ScChatbot/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
2025-09-16 23:40:05,381 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:40:24,542 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:43:21,244 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:43:22,090 | INFO | scchatbot.multi_agent_base | ✅ Unified hierarchical cell type management initialized
2025-09-16 23:43:22,091 | INFO | scchatbot.multi_agent_base | ✅ Unified cell type extractor initialized
2025-09-16 23:43:22,091 | INFO | scchatbot.multi_agent_base | 1
2025-09-16 23:43:22,584 | INFO | sentence_transformers.SentenceTransformer | Use pytorch device_name: mps
2025-09-16 23:43:22,584 | INFO | sentence_transformers.SentenceTransformer | Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-09-16 23:43:24,163 | INFO | scchatbot.multi_agent_base | 2
2025-09-16 23:43:24,165 | INFO | scchatbot.multi_agent_base | 3
2025-09-16 23:43:24,165 | INFO | scchatbot.multi_agent_base | ✅ Session state management initialized
2025-09-16 23:45:34,867 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 23:45:37,892 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 23:45:40,905 | WARNING | django.request | Not Found: /ws/chat/b05944ce/
2025-09-16 23:45:43,972 | INFO | scchatbot.multi_agent_base | 🆕 Creating new session state for 'b05944ce'
2025-09-16 23:45:43,978 | INFO | scchatbot.workflow.node_base | 🔄 InputProcessor: Starting execution
2025-09-16 23:45:43,979 | INFO | scchatbot.workflow.node_base |    Current message: Plot the UMAP with T cell on it....
2025-09-16 23:45:44,810 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:45:44,814 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 LLM search query response: '```json
["current_session_state"]
```'
2025-09-16 23:45:44,814 | INFO | scchatbot.workflow.nodes.input_processing | 🧠 LLM requested 1 context sources: ['current_session_state']
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Building session context...
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Found 0 cell types: []
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.node_base | 🔍 CONTEXT BUILDER: Generated 33 chars, starts with: 'No current session data available...'
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added current session state context (33 chars)
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.nodes.input_processing | 🔍 SESSION CONTEXT DEBUG: First 100 chars: 'No current session data available...'
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.nodes.input_processing | ✅ Added fresh unified context (56 chars)
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.nodes.input_processing | 🔄 Initialized with 4 initial cell types
2025-09-16 23:45:44,815 | INFO | scchatbot.workflow.node_base | ✅ InputProcessor: Execution complete
2025-09-16 23:45:44,817 | INFO | scchatbot.workflow.node_base | 🔄 Planner: Starting execution
2025-09-16 23:45:44,817 | INFO | scchatbot.workflow.node_base |    Current message: Plot the UMAP with T cell on it....
2025-09-16 23:45:44,817 | INFO | scchatbot.workflow.nodes.planning | 🧬 PLANNER: Cell type status for planning:
2025-09-16 23:45:44,821 | INFO | scchatbot.workflow.nodes.planning |    • Initial types: 4
2025-09-16 23:45:44,821 | INFO | scchatbot.workflow.nodes.planning |    • Currently available: 4
2025-09-16 23:45:44,822 | INFO | scchatbot.workflow.nodes.planning |    • Discovered this session: 0
2025-09-16 23:45:44,822 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planning for question: 'Plot the UMAP with T cell on it.'
2025-09-16 23:45:53,157 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:45:55,302 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:45:55,309 | INFO | scchatbot.workflow.nodes.planning | 🧬 Planner identified needed cell types: ['T cell']
2025-09-16 23:45:55,309 | INFO | scchatbot.workflow.nodes.planning | 🧬 Available cell types: ['Epithelial cell', 'Stromal cell', 'Glial cell', 'Immune cell']
2025-09-16 23:45:55,341 | INFO | scchatbot.workflow.nodes.planning | 🧬 Creating discovery steps only...
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning | 🔄 Found path from 'Immune cell' to 'T cell': Immune cell → T cell
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning | 🧬 Added process_cells(Immune cell) to discover ['T cell']
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning | 🔍 Created validation step for process_cells(Immune cell) expecting: ['T cell']
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning | 🔄 Interleaved: process_cells(Immune cell) → validation(Immune cell)
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning | 📋 Plan merge complete:
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning |    - Discovery steps: 1
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning |    - Validation steps: 1
2025-09-16 23:45:55,360 | INFO | scchatbot.workflow.nodes.planning |    - Analysis steps: 0
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning |    - Other steps: 1
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning |    - Filtered out: 0 steps for undiscoverable types
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning | 🔍 ENRICHMENT DEBUG: Found 0 enrichment steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning | 🔍 PATHWAY EXTRACTOR: Processing 3 steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning | ✅ Planner created execution plan with 3 steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning |    • 1 process_cells steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning |    • 1 validation steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning |    • 1 analysis steps
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.node_base | ✅ Planner: Execution complete
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.nodes.planning | FINAL PLAN : 
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 23:45:55,361 | INFO | scchatbot.workflow.node_base |    Current message: Plot the UMAP with T cell on it....
2025-09-16 23:45:55,362 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 1: Process Immune cell to discover T cell
2025-09-16 23:45:55,362 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'process_cells'
2025-09-16 23:46:03,379 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:46:15,376 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:46:59,393 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:46:59,395 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 1 completed successfully
2025-09-16 23:46:59,395 | INFO | scchatbot.workflow.nodes.execution | 🔍 EXECUTION NODE: About to call CellTypeExtractor.extract_from_annotation_result() for process_cells step
2025-09-16 23:46:59,396 | INFO | scchatbot.workflow.nodes.execution | 🧬 Updating hierarchy manager with new cell types: ['T cell', 'B cell', 'Mononuclear phagocyte', 'Natural killer cell', 'Mast cell']
2025-09-16 23:46:59,416 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: T cell
2025-09-16 23:46:59,416 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: B cell
2025-09-16 23:46:59,416 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mononuclear phagocyte
2025-09-16 23:46:59,416 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Natural killer cell
2025-09-16 23:46:59,416 | INFO | scchatbot.workflow.nodes.execution | ✅ Discovered new cell type: Mast cell
2025-09-16 23:46:59,417 | INFO | scchatbot.workflow.nodes.execution | 📊 Structured storage: process_cells - Full data preserved
2025-09-16 23:46:59,417 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 2
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Executing validation step...
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.node_base | 🔄 Validation: Starting execution
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.node_base |    Current message: Validating Immune cell -> ['T cell']...
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Exact match found: 'T cell'
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.node_base | ✅ Validation: Execution complete
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Validation passed: All 1 expected cell types found successfully
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 CALLING update_remaining_steps_with_discovered_types with result status: success
2025-09-16 23:46:59,418 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Updating remaining steps: expected=['T cell'], found=['T cell'], missing=[]
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Validation result full structure: {'status': 'success', 'message': 'All 1 expected cell types found successfully', 'found_children': ['T cell'], 'missing_children': [], 'available_types': ['Mast cell', 'Stromal cell', 'Epithelial cell', 'Glial cell', 'Natural killer cell', 'B cell', 'Mononuclear phagocyte', 'T cell']}
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Will skip steps for missing cell types: []
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Scanning 1 remaining steps...
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3: display_processed_umap(params={})
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 DEBUG: Step 3 cell type 'None' not in missing list []
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Advanced to step 3
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.node_base |    Current message: Plot the UMAP with T cell on it....
2025-09-16 23:46:59,419 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 3: Display the UMAP visualization with annotated cell types.
2025-09-16 23:46:59,420 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_processed_umap'
2025-09-16 23:46:59,420 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_processed_umap' with step parameters: {}
2025-09-16 23:46:59,420 | INFO | scchatbot.workflow.nodes.execution | ✅ Found cell type for display_processed_umap: Immune cell
2025-09-16 23:46:59,420 | INFO | scchatbot.workflow.nodes.execution | 📝 Updating step parameters with enhanced params for execution history tracking
2025-09-16 23:46:59,420 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_processed_umap called with kwargs: {'cell_type': 'Immune cell'}
2025-09-16 23:46:59,933 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 23:46:59,936 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 23:46:59,936 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmprz9cww70.
2025-09-16 23:46:59,936 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 23:46:59,937 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp0x9uo0xq.
2025-09-16 23:46:59,938 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp0x9uo0xq
2025-09-16 23:47:00,503 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmprz9cww70/index.html
2025-09-16 23:47:00,503 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 23:47:01,079 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 23:47:01,080 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 23:47:01,080 | INFO | kaleido.kaleido | Got 7FD3
2025-09-16 23:47:01,080 | INFO | kaleido._kaleido_tab | Processing Immune_cell_Subtypes_UMAP_Plot.png
2025-09-16 23:47:01,080 | INFO | kaleido._kaleido_tab | Sending big command for Immune_cell_Subtypes_UMAP_Plot.png.
2025-09-16 23:47:01,181 | INFO | kaleido._kaleido_tab | Sent big command for Immune_cell_Subtypes_UMAP_Plot.png.
2025-09-16 23:47:01,183 | INFO | kaleido.kaleido | Reloading tab 7FD3 before return.
2025-09-16 23:47:01,276 | INFO | kaleido.kaleido | Putting tab 7FD3 back (queue size: 0).
2025-09-16 23:47:01,276 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 23:47:01,276 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 23:47:01,277 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:01,277 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:01,277 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:01,277 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:01,277 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:01,278 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:01,279 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:01,279 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:01,279 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:01,279 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:01,374 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:01,374 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:01,377 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 23:47:01,378 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 23:47:01,379 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmphajm6256.
2025-09-16 23:47:01,379 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 23:47:01,380 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpl0c0v1c_.
2025-09-16 23:47:01,380 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpl0c0v1c_
2025-09-16 23:47:01,789 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmphajm6256/index.html
2025-09-16 23:47:01,792 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 23:47:02,330 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 23:47:02,330 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 23:47:02,330 | INFO | kaleido.kaleido | Got 331F
2025-09-16 23:47:02,330 | INFO | kaleido._kaleido_tab | Processing Immune_cell_Subtypes_UMAP_Plot.pdf
2025-09-16 23:47:02,330 | INFO | kaleido._kaleido_tab | Sending big command for Immune_cell_Subtypes_UMAP_Plot.pdf.
2025-09-16 23:47:02,403 | INFO | kaleido._kaleido_tab | Sent big command for Immune_cell_Subtypes_UMAP_Plot.pdf.
2025-09-16 23:47:02,458 | INFO | kaleido.kaleido | Reloading tab 331F before return.
2025-09-16 23:47:02,533 | INFO | kaleido.kaleido | Putting tab 331F back (queue size: 0).
2025-09-16 23:47:02,533 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 23:47:02,534 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 23:47:02,534 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:02,534 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:02,534 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:02,534 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:02,534 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:02,535 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:02,535 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:02,535 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:02,535 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:02,535 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:02,624 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:02,624 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:02,635 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 3 completed successfully
2025-09-16 23:47:02,636 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_processed_umap - HTML preserved
2025-09-16 23:47:02,636 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 4
2025-09-16 23:47:02,636 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 23:47:02,637 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 23:47:02,637 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (3/3), running post-execution evaluation
2025-09-16 23:47:02,637 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 23:47:02,637 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 23:47:04,183 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:04,969 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:04,970 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: general_comparison
2025-09-16 23:47:04,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 23:47:06,118 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:06,129 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: general_comparison
2025-09-16 23:47:06,880 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:06,970 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["display_processed_umap"]
```' (length: 38)
2025-09-16 23:47:06,970 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['display_processed_umap']
2025-09-16 23:47:06,970 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 3 entries
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: []
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 No direct matches found for T cell, checking for related executions...
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 Generated missing step: display_processed_umap(T cell)
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found 1 missing steps for T cell
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 1 total supplementary steps
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for general_comparison question
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Added 1 supplementary steps to execution plan (attempt 1/2)
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | 🔄 Marked conversation as incomplete to continue execution
2025-09-16 23:47:06,971 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 3
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 3
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 1
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 23:47:06,972 | INFO | scchatbot.workflow.node_base | 🔄 Executor: Starting execution
2025-09-16 23:47:06,973 | INFO | scchatbot.workflow.node_base |    Current message: Plot the UMAP with T cell on it....
2025-09-16 23:47:06,973 | INFO | scchatbot.workflow.nodes.execution | 🔄 Executing step 4: Post-evaluation: display_processed_umap for T cell
2025-09-16 23:47:06,974 | INFO | scchatbot.workflow.nodes.execution | 🔍 STORAGE DEBUG: Original function_name from plan: 'display_processed_umap'
2025-09-16 23:47:06,974 | INFO | scchatbot.workflow.nodes.execution | 🔍 STEP DEBUG: Calling visualization function 'display_processed_umap' with step parameters: {'cell_type': 'T cell'}
2025-09-16 23:47:06,974 | INFO | scchatbot.multi_agent_base | 🔍 VIZ WRAPPER DEBUG: display_processed_umap called with kwargs: {'cell_type': 'T cell'}
2025-09-16 23:47:07,011 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 23:47:07,013 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 23:47:07,013 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp8b4odc5p.
2025-09-16 23:47:07,014 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 23:47:07,014 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpro34se16.
2025-09-16 23:47:07,014 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmpro34se16
2025-09-16 23:47:07,433 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp8b4odc5p/index.html
2025-09-16 23:47:07,437 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 23:47:07,956 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 23:47:07,957 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 23:47:07,957 | INFO | kaleido.kaleido | Got AACE
2025-09-16 23:47:07,957 | INFO | kaleido._kaleido_tab | Processing T_cell_from_parent_cell_type_UMAP_Plot.png
2025-09-16 23:47:07,957 | INFO | kaleido._kaleido_tab | Sending big command for T_cell_from_parent_cell_type_UMAP_Plot.png.
2025-09-16 23:47:08,051 | INFO | kaleido._kaleido_tab | Sent big command for T_cell_from_parent_cell_type_UMAP_Plot.png.
2025-09-16 23:47:08,053 | INFO | kaleido.kaleido | Reloading tab AACE before return.
2025-09-16 23:47:08,128 | INFO | kaleido.kaleido | Putting tab AACE back (queue size: 0).
2025-09-16 23:47:08,129 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 23:47:08,129 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 23:47:08,129 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:08,129 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:08,129 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:08,129 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:08,129 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:08,130 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:08,130 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:08,130 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:08,130 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:08,130 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:08,217 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:08,218 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:08,220 | INFO | choreographer.browsers.chromium | Chromium init'ed with kwargs {}
2025-09-16 23:47:08,220 | INFO | choreographer.browsers.chromium | Found chromium path: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome
2025-09-16 23:47:08,221 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp03wh09mp.
2025-09-16 23:47:08,221 | INFO | choreographer.browser_async | Opening browser.
2025-09-16 23:47:08,221 | INFO | choreographer.utils._tmpfile | Temp directory created: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp_cob6f2h.
2025-09-16 23:47:08,221 | INFO | choreographer.browsers.chromium | Temporary directory at: /var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp_cob6f2h
2025-09-16 23:47:08,646 | INFO | kaleido.kaleido | Conforming 1 to file:///var/folders/r_/s1247sfn6bl8ypsxp0tj3x3c0000gn/T/tmp03wh09mp/index.html
2025-09-16 23:47:08,647 | INFO | kaleido.kaleido | Waiting on all navigates
2025-09-16 23:47:09,222 | INFO | kaleido.kaleido | All navigates done, putting them all in queue.
2025-09-16 23:47:09,222 | INFO | kaleido.kaleido | Getting tab from queue (has 1)
2025-09-16 23:47:09,222 | INFO | kaleido.kaleido | Got FDE5
2025-09-16 23:47:09,222 | INFO | kaleido._kaleido_tab | Processing T_cell_from_parent_cell_type_UMAP_Plot.pdf
2025-09-16 23:47:09,222 | INFO | kaleido._kaleido_tab | Sending big command for T_cell_from_parent_cell_type_UMAP_Plot.pdf.
2025-09-16 23:47:09,291 | INFO | kaleido._kaleido_tab | Sent big command for T_cell_from_parent_cell_type_UMAP_Plot.pdf.
2025-09-16 23:47:09,348 | INFO | kaleido.kaleido | Reloading tab FDE5 before return.
2025-09-16 23:47:09,427 | INFO | kaleido.kaleido | Putting tab FDE5 back (queue size: 0).
2025-09-16 23:47:09,427 | INFO | kaleido.kaleido | Waiting for all cleanups to finish.
2025-09-16 23:47:09,427 | INFO | kaleido.kaleido | Exiting Kaleido
2025-09-16 23:47:09,427 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:09,427 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:09,427 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:09,427 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:09,427 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:09,428 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:09,429 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:09,429 | INFO | kaleido.kaleido | Cancelling tasks.
2025-09-16 23:47:09,429 | INFO | kaleido.kaleido | Exiting Kaleido/Choreo
2025-09-16 23:47:09,429 | INFO | choreographer.browser_async | Closing browser.
2025-09-16 23:47:09,515 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:09,515 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:09,524 | INFO | scchatbot.workflow.nodes.execution | ✅ Step 4 completed successfully
2025-09-16 23:47:09,526 | INFO | scchatbot.workflow.nodes.execution | 🎨 Visualization storage: display_processed_umap - HTML preserved
2025-09-16 23:47:09,526 | INFO | scchatbot.workflow.nodes.execution | 🔄 Advanced to step 5
2025-09-16 23:47:09,526 | INFO | scchatbot.workflow.nodes.execution | 🛑 Stopping execution after 1 steps
2025-09-16 23:47:09,526 | INFO | scchatbot.workflow.node_base | ✅ Executor: Execution complete
2025-09-16 23:47:09,527 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 23:47:09,527 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 23:47:09,527 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 23:47:09,531 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:09,531 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:09,531 | INFO | choreographer.utils._tmpfile | TemporaryDirectory.cleanup() worked.
2025-09-16 23:47:09,531 | INFO | choreographer.utils._tmpfile | shutil.rmtree worked.
2025-09-16 23:47:11,552 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:12,242 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:12,244 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: general_comparison
2025-09-16 23:47:12,244 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 23:47:12,881 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:12,882 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: general_comparison
2025-09-16 23:47:13,596 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["display_processed_umap"]
```' (length: 38)
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['display_processed_umap']
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_processed_umap (execution 4)
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_processed_umap']
2025-09-16 23:47:13,626 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for general_comparison question
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 23:47:13,627 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 23:47:13,628 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 All steps complete (4/4), running post-execution evaluation
2025-09-16 23:47:13,628 | INFO | scchatbot.workflow.nodes.evaluation | 🏁 Evaluator: Starting sophisticated post-execution evaluation...
2025-09-16 23:47:13,628 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Starting post-execution evaluation...
2025-09-16 23:47:14,837 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:15,439 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:15,455 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: gene_markers
2025-09-16 23:47:15,455 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Evaluating coverage for cell type: T cell
2025-09-16 23:47:17,127 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:17,128 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Question classified as: general_comparison
2025-09-16 23:47:18,185 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 LLM raw response for T cell: '```json
["display_processed_umap"]
```' (length: 38)
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 🧠 LLM recommends for T cell: ['display_processed_umap']
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking if 'T cell' is in unavailable list: []
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 🔧 DEBUG: Checking execution history with 4 entries
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 📋 Found successful analysis for T cell: display_processed_umap (execution 4)
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Actually performed for T cell: ['display_processed_umap']
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Complete coverage for T cell
2025-09-16 23:47:18,186 | INFO | scchatbot.workflow.nodes.evaluation | 🔍 Post-execution evaluation complete: 0 total supplementary steps
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation | 📝 Generated relevance hints for gene_markers question
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation | ✅ Execution Summary:
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation |    • Total steps executed: 4
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation |    • Successful: 4
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation |    • Failed: 0
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation |    • Supplementary steps generated: 0
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation | 📊 Available analysis results:
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.evaluation | 🎯 Evaluator: Post-execution evaluation complete, ready for response generation
2025-09-16 23:47:18,187 | INFO | scchatbot.multi_agent_base | 🔄 Routing: Post-execution evaluation complete, generating response
2025-09-16 23:47:18,187 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generating LLM-synthesized response with conversation awareness...
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 UNIFIED ACCESSOR: Processing 4 execution steps
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 1: process_cells for Immune cell
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling process_cells with ProcessCellsResultAccessor
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 2: validate_processing_results for step_1
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling validate_processing_results with ValidationResultAccessor
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 3: display_processed_umap for step_2
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 3 function: display_processed_umap
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {}
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_processed_umap with VisualizationResultAccessor
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🔍 Step 4: display_processed_umap for T cell
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Step 4 function: display_processed_umap
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🎨 VISUALIZATION DEBUG: Parameters: {'cell_type': 'T cell'}
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | ✅ Handling display_processed_umap with VisualizationResultAccessor
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | ✅ UNIFIED ACCESSOR: Processed 4 successful steps
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.unified_result_accessor | 🎯 UNIFIED FORMATTER: Generated 520 characters for synthesis
2025-09-16 23:47:18,188 | INFO | scchatbot.workflow.nodes.response | ✅ Unified results extracted and formatted successfully
2025-09-16 23:47:18,189 | INFO | scchatbot.workflow.nodes.response | ✅ Failed analyses retrieved
2025-09-16 23:47:18,189 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Found context message (56 chars)
2025-09-16 23:47:18,189 | INFO | scchatbot.workflow.nodes.response | ✅ Conversation context processed
2025-09-16 23:47:18,189 | INFO | scchatbot.workflow.nodes.response | ✅ Discovery search completed
2025-09-16 23:47:18,189 | INFO | scchatbot.workflow.nodes.response | ✅ Synthesis prompt created with relevance hints
2025-09-16 23:47:20,586 | INFO | httpx | HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Checking 4 execution steps
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 1: process_cells, success=True, has_result=True
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 2: validate_processing_results, success=True, has_result=True
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 3: display_processed_umap, success=True, has_result=True
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Added plot plot_1: Annotated UMAP (33026 chars)
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Step 4: display_processed_umap, success=True, has_result=True
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Skipping display_processed_umap - duplicate plot detected
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 PLOT EXTRACTION: Successfully extracted 1 individual plots (total: 33,026 chars)
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 SIZE VALIDATION: Validated 1 plots, total size: 33,026 bytes
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎯 ResponseGeneratorNode: Found 1 individual plots
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 Creating multiple messages structure: 1 plots + 1 text (plots first)
2025-09-16 23:47:20,587 | INFO | scchatbot.workflow.nodes.response | 🎨 Created multiple messages structure with 2 total messages (plots first, then text)
2025-09-16 23:47:20,588 | INFO | scchatbot.workflow.nodes.response | 🎯 UNIFIED: Generated response (311 chars)
2025-09-16 23:47:20,668 | INFO | scchatbot.multi_agent_base | ✅ Conversation recorded in vector database
2025-09-16 23:47:20,669 | INFO | scchatbot.multi_agent_base | 💾 Session state saved for 'b05944ce' with 8 available cell types
